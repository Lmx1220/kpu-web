
/**
 * 由 admin 提供技术支持
 * Powered by admin
 * 代码仓库
 * Github https://github.com/Lmx1220/kpu-web
 */
    
import{r as I,be as g,d as se,a as re,c as ie,D as ue,U as N,ar as de,bf as O,e as c,b2 as pe,o as P,f as ce,h as t,w as o,i as E,q as d,j as a,k,t as H,N as D,O as A,L as me,m as fe,b3 as _e,W as be,_ as ge,V as ve,p as he,l as ye,v as T,z as Ee}from"./index-D6ceO_Rb.js";import{_ as Me}from"./index.vue_vue_type_script_setup_true_lang-CMPY6SEv.js";import{_ as Ve}from"./index.vue_vue_type_script_setup_true_lang-bcVZrhLq.js";import{_ as xe}from"./index.vue_vue_type_script_setup_true_lang-CcbmLhgO.js";import{c as F,A as R}from"./index-CyJDoTHp.js";import{u as Pe}from"./useTabbar-BPuGGY7H.js";function ze(){const u=I({page:1,size:10,total:0,sizes:[2,10,20,50,100],layout:"total, sizes, ->, prev, pager, next, jumper"}),M=I({});function v(l){const e={};for(const n in l)if(Object.prototype.hasOwnProperty.call(l,n)){const r=l[n];typeof r=="string"&&r.trim()===""?e[n]=void 0:Array.isArray(r)?e[n]=r.map(y=>typeof y=="object"&&y!==null?v(y):y):typeof r=="object"&&r!==null?e[n]=v(r):e[n]=r}return e}function h(l,e){const n={current:g(u).page,size:g(u).size,model:{...v(g(l))},extra:{}};return e&&(Array.isArray(e)?e.forEach(r=>{r.prop=r.prop||r.name,r.type==="daterange"?l[r.name]&&(l[r.name][0]&&(n.extra[`${r.prop}_st`]=l[r.name][0]),l[r.name][1]&&(n.extra[`${r.prop}_ed`]=l[r.name][1])):n.extra[r.prop]=l[r.name],delete n.model[r.name]}):(e.prop=e.prop||e.name,e.type==="daterange"?l[e.name]&&(l[e.name][0]&&(n.extra[`${e.prop}_st`]=l[e.name][0]),l[e.name][1]&&(n.extra[`${e.prop}_ed`]=l[e.name][1])):n.extra[e.prop]=l[e.name],delete n.model[e.name])),g(u).sort&&g(u).order&&(n.sort=g(u).sort,n.order=g(u).order),n}function m(l){return new Promise(e=>{u.value.size=l,e()})}function w(l){return new Promise(e=>{u.value.page=l,e()})}function S(l,e){return new Promise(n=>{u.value.sort=l,u.value.order=e==="ascending"?"asc":"desc",n()})}function C(l){const e=M.value;l?Object.assign(e,l):e&&Object.keys(e).forEach(n=>{e[n]=void 0})}return{pagination:u,search:M,getParams:h,onSizeChange:m,onCurrentChange:w,onSortChange:S,resetQuery:C}}const L=u=>(he("data-v-5b6ecda8"),u=u(),ye(),u),ke=L(()=>E("p",null," 同时，标准模块还提供了两个优秀的特性： ",-1)),De={style:{display:"flex","align-items":"center"}},we=L(()=>E("span",{style:{"margin-inline-end":"20px"}},"特性1：列表展示模式",-1)),Se={style:{display:"flex","align-items":"center"}},Ce=L(()=>E("span",{style:{"margin-inline-end":"20px"}},"特性2：表单展示模式",-1)),Be=se({__name:"list",setup(u){const M=re(),v=Pe(),h=ie(),{pagination:m,getParams:w,onSizeChange:S,onCurrentChange:C}=ze(),{t:l}=fe(),e=I({loading:!1,tableAutoHeight:!1,formMode:"router",formModeProps:{visible:!1,id:"",type:void 0},search:{title:"",title2:"",title3:"",title4:""},batch:{enable:!0,selectionDataList:[]},dataList:[]});ue(()=>{n(),e.value.formMode==="router"&&N.on("get-data-list",()=>{n()})}),de(()=>{e.value.formMode==="router"&&N.off("get-data-list")});async function n(p){p&&p===1&&(m.value.page=p),e.value.loading=!0;const s=w({...e.value.search}),b=await F.page(s);e.value.dataList=O(b,"records",[]),m.value.total=Number(b.total),m.value.page=Number(O(b,"current",1)),setTimeout(()=>{e.value.loading=!1},100)}function r(p){S(p).then(()=>n())}function y(p=1){C(p).then(()=>n())}function q(){e.value.formMode==="router"?h.settings.tabbar.enable&&h.settings.tabbar.mergeTabsBy!=="activeMenu"?v.open({name:"standardModuleExampleCreate",params:{type:"add"}}):M.push({name:"standardModuleExampleCreate",params:{type:"add"}}):(e.value.formModeProps.id="",e.value.formModeProps.visible=!0,e.value.formModeProps.type=R.ADD)}function G(p){e.value.formMode==="router"?h.settings.tabbar.enable&&h.settings.tabbar.mergeTabsBy!=="activeMenu"?v.open({name:"standardModuleExampleEdit",params:{id:p.id,type:"edit"}}):M.push({name:"standardModuleExampleEdit",params:{id:p.id,type:"edit"}}):(e.value.formModeProps.id=p.id,e.value.formModeProps.visible=!0,e.value.formModeProps.type=R.EDIT)}function Q(p){let s=[];p?s.push(p.id):s=e.value.batch.selectionDataList.map(b=>b.id),_e.confirm(`确认删除数量「${s.length}」吗？`,"确认信息").then(()=>{F.remove(s).then(()=>{n(),be.success({message:"删除成功",center:!0})})}).catch(()=>{})}return(p,s)=>{const b=c("ElTag"),V=c("el-radio-button"),U=c("el-radio-group"),W=Ve,z=c("ElInput"),x=c("ElFormItem"),B=ge,f=c("ElButton"),J=c("ElForm"),K=Me,X=c("ElDivider"),Y=c("ElButtonGroup"),Z=c("ElSpace"),ee=c("el-table-column"),j=c("ElTableColumn"),te=c("ElPopconfirm"),ae=c("ElTable"),oe=c("el-pagination"),le=ve,ne=pe("loading");return P(),ce("div",{class:me({"absolute-container":a(e).tableAutoHeight})},[t(W,{title:"标准模块"},{content:o(()=>[E("p",null,[d("标准模块即包含 CRUD (增查改删) 操作的基础模块，开发者可通过 "),t(b,null,{default:o(()=>[d("pnpm run new")]),_:1}),d(" 命令快速生成一个标准模块，并在此基础上完善业务模块所需要的功能。")]),ke,E("p",De,[we,t(U,{modelValue:a(e).tableAutoHeight,"onUpdate:modelValue":s[0]||(s[0]=i=>a(e).tableAutoHeight=i),size:"large"},{default:o(()=>[t(V,{value:!1},{default:o(()=>[d(" 默认 ")]),_:1}),t(V,{value:!0},{default:o(()=>[d(" 列表高度自适应 ")]),_:1})]),_:1},8,["modelValue"])]),E("p",Se,[Ce,t(U,{modelValue:a(e).formMode,"onUpdate:modelValue":s[1]||(s[1]=i=>a(e).formMode=i),size:"large"},{default:o(()=>[t(V,{value:"router"},{default:o(()=>[d(" 路由跳转 ")]),_:1}),t(V,{value:"dialog"},{default:o(()=>[d(" 对话框 ")]),_:1}),t(V,{value:"drawer"},{default:o(()=>[d(" 抽屉 ")]),_:1})]),_:1},8,["modelValue"])])]),_:1}),t(le,null,{default:o(()=>[t(K,{class:"relative","show-toggle":!1},{default:o(({fold:i,toggle:$})=>[t(J,{model:a(e).search,size:"default","label-width":"100px","inline-message":"",inline:"",class:"search-form"},{default:o(()=>[t(x,{label:"标题"},{default:o(()=>[t(z,{modelValue:a(e).search.title,"onUpdate:modelValue":s[2]||(s[2]=_=>a(e).search.title=_),placeholder:"请输入标题，支持模糊查询",clearable:""},null,8,["modelValue"])]),_:1}),k(t(x,{label:"标题2"},{default:o(()=>[t(z,{modelValue:a(e).search.title2,"onUpdate:modelValue":s[3]||(s[3]=_=>a(e).search.title2=_),placeholder:"请输入标题，支持模糊查询",clearable:""},null,8,["modelValue"])]),_:2},1536),[[T,i]]),k(t(x,{label:"标题3"},{default:o(()=>[t(z,{modelValue:a(e).search.title3,"onUpdate:modelValue":s[4]||(s[4]=_=>a(e).search.title3=_),placeholder:"请输入标题，支持模糊查询",clearable:""},null,8,["modelValue"])]),_:2},1536),[[T,i]]),k(t(x,{label:"标题4"},{default:o(()=>[t(z,{modelValue:a(e).search.title4,"onUpdate:modelValue":s[5]||(s[5]=_=>a(e).search.title4=_),placeholder:"请输入标题，支持模糊查询",clearable:""},null,8,["modelValue"])]),_:2},1536),[[T,i]]),t(x,null,{default:o(()=>[t(f,{type:"primary",onClick:s[6]||(s[6]=_=>n())},{icon:o(()=>[t(B,{name:"i-ep:search"})]),default:o(()=>[d(" 筛选 ")]),_:1}),t(f,{link:"",onClick:$},{icon:o(()=>[t(B,{name:i?"i-ep:caret-bottom":"i-ep:caret-top"},null,8,["name"])]),default:o(()=>[d(" "+H(i?"展开":"收起"),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["model"])]),_:1}),t(X),t(Z,null,{default:o(()=>[t(f,{type:"primary",onClick:s[7]||(s[7]=i=>q())},{icon:o(()=>[t(B,{name:"ep:plus"})]),default:o(()=>[d(" "+H(a(l)("common.title.addRoot")),1)]),_:1}),t(f,{disabled:!a(e).batch.selectionDataList.length},{default:o(()=>[d(" 单个批量操作按钮 ")]),_:1},8,["disabled"]),a(e).batch.enable?(P(),D(Y,{key:0},{default:o(()=>[t(f,{disabled:!a(e).batch.selectionDataList.length},{default:o(()=>[d(" 单个批量操作按钮1 ")]),_:1},8,["disabled"]),t(f,{disabled:!a(e).batch.selectionDataList.length},{default:o(()=>[d(" 单个批量操作按钮2 ")]),_:1},8,["disabled"])]),_:1})):A("",!0)]),_:1}),k((P(),D(ae,{class:"list-table",data:a(e).dataList,stripe:"","highlight-current-row":"",border:"",onSelectionChange:s[8]||(s[8]=i=>a(e).batch.selectionDataList=i)},{default:o(()=>[a(e).batch.enable?(P(),D(ee,{key:0,type:"selection",align:"center",fixed:""})):A("",!0),t(j,{prop:"title",label:a(l)("system.resource.title"),"min-width":"200",fixed:"left"},null,8,["label"]),t(j,{align:"center",fixed:"right",label:"操作",width:"350"},{default:o(i=>[t(f,{link:"",size:"small",type:"primary",onClick:$=>G(i.row)},{default:o(()=>[d(" 编辑 ")]),_:2},1032,["onClick"]),t(te,{title:a(l)("common.tips.confirmDelete"),onConfirm:$=>Q(i.row)},{reference:o(()=>[t(f,{link:"",size:"small",type:"danger"},{default:o(()=>[d(" 刪除 ")]),_:1})]),_:2},1032,["title","onConfirm"])]),_:1})]),_:1},8,["data"])),[[ne,a(e).loading]]),t(oe,{"current-page":a(m).page,total:a(m).total,"page-size":a(m).size,"page-sizes":a(m).sizes,layout:a(m).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:r,onCurrentChange:y},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1}),["dialog","drawer"].includes(a(e).formMode)?(P(),D(xe,{key:0,id:a(e).formModeProps.id,modelValue:a(e).formModeProps.visible,"onUpdate:modelValue":s[9]||(s[9]=i=>a(e).formModeProps.visible=i),type:a(e).formModeProps.type,mode:a(e).formMode,onSuccess:n},null,8,["id","modelValue","type","mode"])):A("",!0)],2)}}}),je=Ee(Be,[["__scopeId","data-v-5b6ecda8"]]);export{je as default};
