
/**
 * 由 admin 提供技术支持
 * Powered by admin
 * 代码仓库
 * Github https://github.com/Lmx1220/kpu-web
 */
    
import{d as P,aI as g,o as h,f as O,w as _,a as k,b as l,i as o,h as j,M as J,bE as b,m as A,s as F,a3 as R,a4 as H,r as B,F as G,l as X,q as I,S as V,U,n as N,e as v,R as K}from"./bootstrap-CFLGDgEx.js";import{_ as Q}from"./index.vue_vue_type_script_setup_true_lang-CjgLcnfR.js";import{_ as W}from"./index.vue_vue_type_script_setup_true_lang-Cmc5FAQ9.js";import{b as D}from"./route-block-B_A1xBdJ.js";import"./index-CWw-wBac.js";const Y={class:"slot"},Z={key:0,class:"el-upload__tip"},x={style:{display:"inline-block"}},ee=P({name:"FileUpload",__name:"index",props:{action:{},headers:{},data:{},name:{default:"file"},size:{default:2},max:{default:3},files:{default:()=>[]},notip:{type:Boolean,default:!1},ext:{default:()=>["zip","rar"]},httpRequest:{}},emits:["onSuccess"],setup(y,{emit:$}){const r=y,E=$,s=t=>{const d=t.name.split(".").at(-1)??"",u=r.ext.includes(d),i=t.size/1024/1024<r.size;return u||b.error(`上传文件只支持 ${r.ext.join(" / ")} 格式！`),i||b.error(`上传文件大小不能超过 ${r.size}MB！`),u&&i},a=()=>{b.warning("文件上传超过限制")},C=(t,n,d)=>{E("onSuccess",t,n,d)},z=t=>{(d=>new Promise(u=>{const i=new XMLHttpRequest;i.open("GET",d,!0),i.responseType="blob",i.onload=()=>{i.status===200&&u(i.response)},i.send()}))(t.url).then(d=>{const u=document.createElement("a"),i=window.URL.createObjectURL(d),e=new MouseEvent("click");u.target="_blank",u.download=t.name,u.href=i,u.dispatchEvent(e)})};return(t,n)=>{const d=A,u=g("ElAlert"),i=g("ElUpload");return h(),O(i,{headers:t.headers,action:t.action,data:t.data,name:t.name,"before-upload":s,"on-exceed":a,"on-success":C,"on-preview":z,"http-request":t.httpRequest,"file-list":t.files,limit:t.max,drag:""},{tip:_(()=>[t.notip?j("",!0):(h(),k("div",Z,[l("div",x,[o(u,{title:`上传文件支持 ${t.ext.join(" / ")} 格式，单个文件大小不超过 ${t.size}MB，且文件数量不超过 ${t.max} 个`,type:"info","show-icon":"",closable:!1},null,8,["title"])])]))]),default:_(()=>[l("div",Y,[o(d,{name:"i-ep:upload-filled",class:"el-icon--upload"}),n[0]||(n[0]=l("div",{class:"el-upload__text"},[J(" 将文件拖到此处，或"),l("em",null,"点击上传")],-1))])]),_:1},8,["headers","action","data","name","http-request","file-list","limit"])}}}),te=F(ee,[["__scopeId","data-v-dcbfe806"]]),se={class:"upload-container"},oe={class:"mask"},ae={class:"actions"},le=["onClick"],ie=["onClick"],ne=["onClick"],pe=["onClick"],ce={key:0,class:"el-upload__tip"},re={style:{display:"inline-block"}},ue=P({name:"ImagesUpload",__name:"index",props:R({action:{},headers:{},data:{},name:{default:"file"},size:{default:2},max:{default:3},width:{default:150},height:{default:150},placeholder:{default:""},notip:{type:Boolean,default:!1},ext:{default:()=>["jpg","png","gif","bmp"]}},{modelValue:{default:[]},modelModifiers:{}}),emits:R(["onSuccess"],["update:modelValue"]),setup(y,{emit:$}){const r=y,E=$,s=H(y,"modelValue"),a=B({dialogImageIndex:0,imageViewerVisible:!1,progress:{preview:"",percent:0}});function C(e){a.value.dialogImageIndex=e,a.value.imageViewerVisible=!0}function z(){a.value.imageViewerVisible=!1}function t(e){s.value.splice(e,1)}function n(e,w){w==="left"&&e!==0&&(s.value[e]=s.value.splice(e-1,1,s.value[e])[0]),w==="right"&&e!==s.value.length-1&&(s.value[e]=s.value.splice(e+1,1,s.value[e])[0])}const d=e=>{const f=e.name.split(".").at(-1)??"",p=r.ext.includes(f),c=e.size/1024/1024<r.size;return p||b.error(`上传图片只支持 ${r.ext.join(" / ")} 格式！`),c||b.error(`上传图片大小不能超过 ${r.size}MB！`),p&&c&&(a.value.progress.preview=URL.createObjectURL(e)),p&&c},u=e=>{a.value.progress.percent=~~e.percent},i=e=>{a.value.progress.preview="",a.value.progress.percent=0,E("onSuccess",e)};return(e,w)=>{const f=g("ElImage"),p=A,c=g("ElProgress"),S=g("ElUpload"),T=g("ElAlert"),L=g("ElImageViewer");return h(),k("div",se,[(h(!0),k(G,null,X(s.value,(q,m)=>(h(),k("div",{key:m,class:"images"},[m<e.max?(h(),O(f,{key:0,src:q,style:I(`width:${e.width}px;height:${e.height}px;`),fit:"cover"},null,8,["src","style"])):j("",!0),l("div",oe,[l("div",ae,[l("span",{title:"预览",onClick:M=>C(m)},[o(p,{name:"i-ep:zoom-in",class:"icon"})],8,le),l("span",{title:"移除",onClick:M=>t(m)},[o(p,{name:"i-ep:delete",class:"icon"})],8,ie),V(l("span",{title:"左移",class:N({disabled:m===0}),onClick:M=>n(m,"left")},[o(p,{name:"i-ep:back",class:"icon"})],10,ne),[[U,s.value.length>1]]),V(l("span",{title:"右移",class:N({disabled:m===s.value.length-1}),onClick:M=>n(m,"right")},[o(p,{name:"i-ep:right",class:"icon"})],10,pe),[[U,s.value.length>1]])])])]))),128)),V(o(S,{"show-file-list":!1,headers:e.headers,action:e.action,data:e.data,name:e.name,"before-upload":d,"on-progress":u,"on-success":i,drag:"",class:"images-upload"},{default:_(()=>[l("div",{class:"image-slot",style:I(`width:${e.width}px;height:${e.height}px;`)},[o(p,{name:"i-ep:plus",class:"icon"})],4),V(l("div",{class:"progress",style:I(`width:${e.width}px;height:${e.height}px;`)},[o(f,{src:v(a).progress.preview,style:I(`width:${e.width}px;height:${e.height}px;`),fit:"fill"},null,8,["src","style"]),o(c,{type:"circle",width:Math.min(e.width,e.height)*.8,percentage:v(a).progress.percent},null,8,["width","percentage"])],4),[[U,v(a).progress.percent]])]),_:1},8,["headers","action","data","name"]),[[U,s.value.length<e.max]]),e.notip?j("",!0):(h(),k("div",ce,[l("div",re,[o(T,{title:`上传图片支持 ${e.ext.join(" / ")} 格式，单张图片大小不超过 ${e.size}MB，建议图片尺寸为 ${e.width}*${e.height}，且图片数量不超过 ${e.max} 张`,type:"info","show-icon":"",closable:!1},null,8,["title"])])])),v(a).imageViewerVisible?(h(),O(L,{key:1,"url-list":s.value,"initial-index":v(a).dialogImageIndex,teleported:"",onClose:z},null,8,["url-list","initial-index"])):j("",!0)])}}}),de=F(ue,[["__scopeId","data-v-ae0346ce"]]),me={class:"upload-container"},he={class:"mask"},ge={class:"actions"},fe=["onClick"],ve=["onClick"],_e=["onClick"],we=["onClick"],$e={key:0,class:"el-upload__tip"},ke={style:{display:"inline-block"}},be=P({name:"ImagesUpload",__name:"index",props:R({action:{},headers:{},data:{},name:{default:"file"},size:{default:2},max:{default:3},width:{default:150},height:{default:150},placeholder:{default:""},notip:{type:Boolean,default:!1},ext:{default:()=>["jpg","png","gif","bmp"]}},{modelValue:{default:[]},modelModifiers:{}}),emits:R(["onSuccess"],["update:modelValue"]),setup(y,{emit:$}){const r=y,E=$,s=H(y,"modelValue"),a=B({dialogImageIndex:0,imageViewerVisible:!1,progress:{preview:"",percent:0}});function C(e){a.value.dialogImageIndex=e,a.value.imageViewerVisible=!0}function z(){a.value.imageViewerVisible=!1}function t(e){s.value.splice(e,1)}function n(e,w){w==="left"&&e!==0&&(s.value[e]=s.value.splice(e-1,1,s.value[e])[0]),w==="right"&&e!==s.value.length-1&&(s.value[e]=s.value.splice(e+1,1,s.value[e])[0])}const d=e=>{const f=e.name.split(".").at(-1)??"",p=r.ext.includes(f),c=e.size/1024/1024<r.size;return p||b.error(`上传图片只支持 ${r.ext.join(" / ")} 格式！`),c||b.error(`上传图片大小不能超过 ${r.size}MB！`),p&&c&&(a.value.progress.preview=URL.createObjectURL(e)),p&&c},u=e=>{a.value.progress.percent=~~e.percent},i=e=>{a.value.progress.preview="",a.value.progress.percent=0,E("onSuccess",e)};return(e,w)=>{const f=g("ElImage"),p=A,c=g("ElProgress"),S=g("ElUpload"),T=g("ElAlert"),L=g("ElImageViewer");return h(),k("div",me,[(h(!0),k(G,null,X(s.value,(q,m)=>(h(),k("div",{key:m,class:"images"},[m<e.max?(h(),O(f,{key:0,src:q,style:I(`width:${e.width}px;height:${e.height}px;`),fit:"cover"},null,8,["src","style"])):j("",!0),l("div",he,[l("div",ge,[l("span",{title:"预览",onClick:M=>C(m)},[o(p,{name:"i-ep:zoom-in",class:"icon"})],8,fe),l("span",{title:"移除",onClick:M=>t(m)},[o(p,{name:"i-ep:delete",class:"icon"})],8,ve),V(l("span",{title:"左移",class:N({disabled:m===0}),onClick:M=>n(m,"left")},[o(p,{name:"i-ep:back",class:"icon"})],10,_e),[[U,s.value.length>1]]),V(l("span",{title:"右移",class:N({disabled:m===s.value.length-1}),onClick:M=>n(m,"right")},[o(p,{name:"i-ep:right",class:"icon"})],10,we),[[U,s.value.length>1]])])])]))),128)),V(o(S,{"show-file-list":!1,headers:e.headers,action:e.action,data:e.data,name:e.name,"before-upload":d,"on-progress":u,"on-success":i,drag:"",class:"images-upload"},{default:_(()=>[l("div",{class:"image-slot",style:I(`width:${e.width}px;height:${e.height}px;`)},[o(p,{name:"i-ep:plus",class:"icon"})],4),V(l("div",{class:"progress",style:I(`width:${e.width}px;height:${e.height}px;`)},[o(f,{src:v(a).progress.preview,style:I(`width:${e.width}px;height:${e.height}px;`),fit:"fill"},null,8,["src","style"]),o(c,{type:"circle",width:Math.min(e.width,e.height)*.8,percentage:v(a).progress.percent},null,8,["width","percentage"])],4),[[U,v(a).progress.percent]])]),_:1},8,["headers","action","data","name"]),[[U,s.value.length<e.max]]),e.notip?j("",!0):(h(),k("div",$e,[l("div",ke,[o(T,{title:`上传图片支持 ${e.ext.join(" / ")} 格式，单张图片大小不超过 ${e.size}MB，建议图片尺寸为 ${e.width}*${e.height}，且图片数量不超过 ${e.max} 张`,type:"info","show-icon":"",closable:!1},null,8,["title"])])])),v(a).imageViewerVisible?(h(),O(L,{key:1,"url-list":s.value,"initial-index":v(a).dialogImageIndex,teleported:"",onClose:z},null,8,["url-list","initial-index"])):j("",!0)])}}}),ye=F(be,[["__scopeId","data-v-dacb1476"]]),Ee=P({name:"ComponentExampleUpload",__name:"upload.demo",setup(y){const $=B("https://picsum.photos/750/450"),r=B(["https://picsum.photos/400","https://picsum.photos/600","https://picsum.photos/500"]),E=B([{name:"测试文件.zip",url:"http://images.lookbi.com/uploads/apply/96/d8521fc691e472eec91a170201866e7d.zip"}]);function s(t){t.error===""?$.value=t.data.path:b.warning(t.error)}function a(t){t.error===""?r.value.push(t.data.path):b.warning(t.error)}function C(t,n,d){t.error===""?E.value.push({name:n.name,url:t.error===""?t.data.path:""}):(d.pop(),b.warning(t.error))}const z=[{image:"https://picsum.photos/750/450",images:["https://picsum.photos/400","https://picsum.photos/600","https://picsum.photos/500"]},{image:"https://picsum.photos/750/450",images:["https://picsum.photos/400","https://picsum.photos/600","https://picsum.photos/500"]},{image:"https://picsum.photos/750/450",images:["https://picsum.photos/400","https://picsum.photos/600","https://picsum.photos/500"]},{image:"https://picsum.photos/750/450",images:["https://picsum.photos/400","https://picsum.photos/600","https://picsum.photos/500"]}];return(t,n)=>{const d=W,u=ye,i=Q,e=de,w=te,f=g("ElTableColumn"),p=g("ElTable");return h(),k("div",null,[o(d,{title:"上传"},{content:_(()=>n[2]||(n[2]=[l("p",null,"ImageUpload / ImagesUpload / FileUpload",-1),l("p",{style:{"margin-bottom":"0"}}," 由于线上演示环境开启了 Mock ，会导致上传功能报错，请在本地运行并查看演示 ",-1)])),_:1}),o(i,{title:"单图上传"},{default:_(()=>[o(u,{url:v($),"onUpdate:url":n[0]||(n[0]=c=>K($)?$.value=c:null),action:"https://console-mock.apipost.cn/app/mock/project/1f50f1da-5189-4282-d3c7-c133a514c5a8/upload/image",name:"image",width:250,height:150,onOnSuccess:s},null,8,["url"])]),_:1}),o(i,{title:"多图上传（默认最多3张）"},{default:_(()=>[o(e,{modelValue:v(r),"onUpdate:modelValue":n[1]||(n[1]=c=>K(r)?r.value=c:null),action:"https://console-mock.apipost.cn/app/mock/project/1f50f1da-5189-4282-d3c7-c133a514c5a8/upload/image",name:"image",onOnSuccess:a},null,8,["modelValue"])]),_:1}),o(i,{title:"文件上传（默认最多3个）"},{default:_(()=>[o(w,{files:v(E),action:"https://console-mock.apipost.cn/app/mock/project/1f50f1da-5189-4282-d3c7-c133a514c5a8/upload/file",onOnSuccess:C},null,8,["files"])]),_:1}),o(i,{title:"结合 el-table 使用"},{default:_(()=>[o(p,{data:z,style:{width:"100%"}},{default:_(()=>[o(f,{type:"index",width:"50",fixed:"left"}),o(f,{label:"单张图片"},{default:_(({row:c})=>[o(u,{url:c.image,"onUpdate:url":S=>c.image=S,action:"https://console-mock.apipost.cn/app/mock/project/1f50f1da-5189-4282-d3c7-c133a514c5a8/upload/image",name:"image",width:250,height:150,onOnSuccess:s},null,8,["url","onUpdate:url"])]),_:1}),o(f,{label:"多张图片"},{default:_(({row:c})=>[o(e,{url:c.images,"onUpdate:url":S=>c.images=S,action:"https://console-mock.apipost.cn/app/mock/project/1f50f1da-5189-4282-d3c7-c133a514c5a8/upload/image",name:"image",onOnSuccess:a},null,8,["url","onUpdate:url"])]),_:1})]),_:1})]),_:1})])}}});typeof D=="function"&&D(Ee);export{Ee as default};
