
/**
 * 由 admin 提供技术支持
 * Powered by admin
 * 代码仓库
 * Github https://github.com/Lmx1220/kpu-web
 */
    
import{d as P,aj as y,ak as A,r as F,B as c,o as n,c as h,F as R,Q as G,h as C,C as g,i as _,e as l,j as i,D as v,G as f,n as V,w as Q,f as p,M as b,_ as T}from"./index-vu1a6MAo.js";import{_ as q}from"./_plugin-vue_export-helper-DlAUqK2U.js";const H={class:"upload-container"},J={class:"mask"},K={class:"actions"},W=["onClick"],X=["onClick"],Y=["onClick"],Z=["onClick"],x={key:0,class:"el-upload__tip"},ee={style:{display:"inline-block"}},se=P({name:"ImagesUpload",__name:"index",props:y({action:{},headers:{},data:{},name:{default:"file"},size:{default:2},max:{default:3},width:{default:150},height:{default:150},placeholder:{default:""},notip:{type:Boolean,default:!1},ext:{default:()=>["jpg","png","gif","bmp"]}},{modelValue:{default:[]},modelModifiers:{}}),emits:y(["onSuccess"],["update:modelValue"]),setup(k,{emit:E}){const d=k,I=E,s=A(k,"modelValue"),a=F({dialogImageIndex:0,imageViewerVisible:!1,progress:{preview:"",percent:0}});function z(e){a.value.dialogImageIndex=e,a.value.imageViewerVisible=!0}function B(){a.value.imageViewerVisible=!1}function M(e){s.value.splice(e,1)}function $(e,u){u==="left"&&e!==0&&(s.value[e]=s.value.splice(e-1,1,s.value[e])[0]),u==="right"&&e!==s.value.length-1&&(s.value[e]=s.value.splice(e+1,1,s.value[e])[0])}const S=e=>{const m=e.name.split(".").at(-1)??"",t=d.ext.includes(m),r=e.size/1024/1024<d.size;return t||b.error(`上传图片只支持 ${d.ext.join(" / ")} 格式！`),r||b.error(`上传图片大小不能超过 ${d.size}MB！`),t&&r&&(a.value.progress.preview=URL.createObjectURL(e)),t&&r},j=e=>{a.value.progress.percent=~~e.percent},U=e=>{a.value.progress.preview="",a.value.progress.percent=0,I("onSuccess",e)};return(e,u)=>{const m=c("ElImage"),t=T,r=c("ElProgress"),N=c("ElUpload"),D=c("ElAlert"),L=c("ElImageViewer");return n(),h("div",H,[(n(!0),h(R,null,G(s.value,(O,o)=>(n(),h("div",{key:o,class:"images"},[o<e.max?(n(),C(m,{key:0,src:O,style:g(`width:${e.width}px;height:${e.height}px;`),fit:"cover"},null,8,["src","style"])):_("",!0),l("div",J,[l("div",K,[l("span",{title:"预览",onClick:w=>z(o)},[i(t,{name:"i-ep:zoom-in",class:"icon"})],8,W),l("span",{title:"移除",onClick:w=>M(o)},[i(t,{name:"i-ep:delete",class:"icon"})],8,X),v(l("span",{title:"左移",class:V({disabled:o===0}),onClick:w=>$(o,"left")},[i(t,{name:"i-ep:back",class:"icon"})],10,Y),[[f,s.value.length>1]]),v(l("span",{title:"右移",class:V({disabled:o===s.value.length-1}),onClick:w=>$(o,"right")},[i(t,{name:"i-ep:right",class:"icon"})],10,Z),[[f,s.value.length>1]])])])]))),128)),v(i(N,{"show-file-list":!1,headers:e.headers,action:e.action,data:e.data,name:e.name,"before-upload":S,"on-progress":j,"on-success":U,drag:"",class:"images-upload"},{default:Q(()=>[l("div",{class:"image-slot",style:g(`width:${e.width}px;height:${e.height}px;`)},[i(t,{name:"i-ep:plus",class:"icon"})],4),v(l("div",{class:"progress",style:g(`width:${e.width}px;height:${e.height}px;`)},[i(m,{src:p(a).progress.preview,style:g(`width:${e.width}px;height:${e.height}px;`),fit:"fill"},null,8,["src","style"]),i(r,{type:"circle",width:Math.min(e.width,e.height)*.8,percentage:p(a).progress.percent},null,8,["width","percentage"])],4),[[f,p(a).progress.percent]])]),_:1},8,["headers","action","data","name"]),[[f,s.value.length<e.max]]),e.notip?_("",!0):(n(),h("div",x,[l("div",ee,[i(D,{title:`上传图片支持 ${e.ext.join(" / ")} 格式，单张图片大小不超过 ${e.size}MB，建议图片尺寸为 ${e.width}*${e.height}，且图片数量不超过 ${e.max} 张`,type:"info","show-icon":"",closable:!1},null,8,["title"])])])),p(a).imageViewerVisible?(n(),C(L,{key:1,"url-list":s.value,"initial-index":p(a).dialogImageIndex,teleported:"",onClose:B},null,8,["url-list","initial-index"])):_("",!0)])}}}),le=q(se,[["__scopeId","data-v-712d2a29"]]);export{le as _};
