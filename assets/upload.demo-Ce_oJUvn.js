
/**
 * 由 admin 提供技术支持
 * Powered by admin
 * 代码仓库
 * Github https://github.com/Lmx1220/kpu-web
 */
    
import{d as N,e as g,o as f,M as B,w as m,f as E,i as c,h as s,N as M,y as b,_ as q,p as X,l as G,q as K,z as A,aN as T,aO as Y,r as j,O as J,X as Q,L as V,k as z,v as C,K as R,j as k,Y as L,U as W,V as P}from"./index-BXr9q79w.js";import{_ as Z}from"./index-C1kRuXaD.js";import{_ as x}from"./index.vue_vue_type_script_setup_true_lang-CyYew6Mu.js";const ee=h=>(X("data-v-629a72e1"),h=h(),G(),h),te={class:"slot"},se=ee(()=>c("div",{class:"el-upload__text"},[K(" 将文件拖到此处，或"),c("em",null,"点击上传")],-1)),oe={key:0,class:"el-upload__tip"},ae={style:{display:"inline-block"}},le=N({name:"FileUpload",__name:"index",props:{action:{},headers:{},data:{},name:{default:"file"},size:{default:2},max:{default:3},files:{default:()=>[]},notip:{type:Boolean,default:!1},ext:{default:()=>["zip","rar"]},httpRequest:{}},emits:["onSuccess"],setup(h,{emit:_}){const r=h,$=_,a=t=>{const i=t.name.split(".").at(-1)??"",n=r.ext.includes(i),o=t.size/1024/1024<r.size;return n||b.error(`上传文件只支持 ${r.ext.join(" / ")} 格式！`),o||b.error(`上传文件大小不能超过 ${r.size}MB！`),n&&o},l=()=>{b.warning("文件上传超过限制")},U=(t,u,i)=>{$("onSuccess",t,u,i)},S=t=>{(i=>new Promise(n=>{const o=new XMLHttpRequest;o.open("GET",i,!0),o.responseType="blob",o.onload=()=>{o.status===200&&n(o.response)},o.send()}))(t.url).then(i=>{const n=document.createElement("a"),o=window.URL.createObjectURL(i),e=new MouseEvent("click");n.target="_blank",n.download=t.name,n.href=o,n.dispatchEvent(e)})};return(t,u)=>{const i=q,n=g("ElAlert"),o=g("ElUpload");return f(),B(o,{headers:t.headers,action:t.action,data:t.data,name:t.name,"before-upload":a,"on-exceed":l,"on-success":U,"on-preview":S,"http-request":t.httpRequest,"file-list":t.files,limit:t.max,drag:""},{tip:m(()=>[t.notip?M("",!0):(f(),E("div",oe,[c("div",ae,[s(n,{title:`上传文件支持 ${t.ext.join(" / ")} 格式，单个文件大小不超过 ${t.size}MB，且文件数量不超过 ${t.max} 个`,type:"info","show-icon":"",closable:!1},null,8,["title"])])]))]),default:m(()=>[c("div",te,[s(i,{name:"i-ep:upload-filled",class:"el-icon--upload"}),se])]),_:1},8,["headers","action","data","name","http-request","file-list","limit"])}}}),ne=A(le,[["__scopeId","data-v-629a72e1"]]),ie={class:"upload-container"},pe={class:"mask"},ce={class:"actions"},re=["onClick"],ue=["onClick"],de=["onClick"],me=["onClick"],he={key:0,class:"el-upload__tip"},fe={style:{display:"inline-block"}},ge=N({name:"ImagesUpload",__name:"index",props:T({action:{},headers:{},data:{},name:{default:"file"},size:{default:2},max:{default:3},width:{default:150},height:{default:150},placeholder:{default:""},notip:{type:Boolean,default:!1},ext:{default:()=>["jpg","png","gif","bmp"]}},{modelValue:{default:[]},modelModifiers:{}}),emits:T(["onSuccess"],["update:modelValue"]),setup(h,{emit:_}){const r=h,$=_,a=Y(h,"modelValue"),l=j({dialogImageIndex:0,imageViewerVisible:!1,progress:{preview:"",percent:0}});function U(e){l.value.dialogImageIndex=e,l.value.imageViewerVisible=!0}function S(){l.value.imageViewerVisible=!1}function t(e){a.value.splice(e,1)}function u(e,y){y==="left"&&e!==0&&(a.value[e]=a.value.splice(e-1,1,a.value[e])[0]),y==="right"&&e!==a.value.length-1&&(a.value[e]=a.value.splice(e+1,1,a.value[e])[0])}const i=e=>{const v=e.name.split(".").at(-1)??"",d=r.ext.includes(v),p=e.size/1024/1024<r.size;return d||b.error(`上传图片只支持 ${r.ext.join(" / ")} 格式！`),p||b.error(`上传图片大小不能超过 ${r.size}MB！`),d&&p&&(l.value.progress.preview=URL.createObjectURL(e)),d&&p},n=e=>{l.value.progress.percent=~~e.percent},o=e=>{l.value.progress.preview="",l.value.progress.percent=0,$("onSuccess",e)};return(e,y)=>{const v=g("ElImage"),d=q,p=g("ElProgress"),I=g("ElUpload"),F=g("ElAlert"),D=g("ElImageViewer");return f(),E("div",ie,[(f(!0),E(J,null,Q(a.value,(H,w)=>(f(),E("div",{key:w,class:"images"},[w<e.max?(f(),B(v,{key:0,src:H,style:V(`width:${e.width}px;height:${e.height}px;`),fit:"cover"},null,8,["src","style"])):M("",!0),c("div",pe,[c("div",ce,[c("span",{title:"预览",onClick:O=>U(w)},[s(d,{name:"i-ep:zoom-in",class:"icon"})],8,re),c("span",{title:"移除",onClick:O=>t(w)},[s(d,{name:"i-ep:delete",class:"icon"})],8,ue),z(c("span",{title:"左移",class:R({disabled:w===0}),onClick:O=>u(w,"left")},[s(d,{name:"i-ep:back",class:"icon"})],10,de),[[C,a.value.length>1]]),z(c("span",{title:"右移",class:R({disabled:w===a.value.length-1}),onClick:O=>u(w,"right")},[s(d,{name:"i-ep:right",class:"icon"})],10,me),[[C,a.value.length>1]])])])]))),128)),z(s(I,{"show-file-list":!1,headers:e.headers,action:e.action,data:e.data,name:e.name,"before-upload":i,"on-progress":n,"on-success":o,drag:"",class:"images-upload"},{default:m(()=>[c("div",{class:"image-slot",style:V(`width:${e.width}px;height:${e.height}px;`)},[s(d,{name:"i-ep:plus",class:"icon"})],4),z(c("div",{class:"progress",style:V(`width:${e.width}px;height:${e.height}px;`)},[s(v,{src:k(l).progress.preview,style:V(`width:${e.width}px;height:${e.height}px;`),fit:"fill"},null,8,["src","style"]),s(p,{type:"circle",width:Math.min(e.width,e.height)*.8,percentage:k(l).progress.percent},null,8,["width","percentage"])],4),[[C,k(l).progress.percent]])]),_:1},8,["headers","action","data","name"]),[[C,a.value.length<e.max]]),e.notip?M("",!0):(f(),E("div",he,[c("div",fe,[s(F,{title:`上传图片支持 ${e.ext.join(" / ")} 格式，单张图片大小不超过 ${e.size}MB，建议图片尺寸为 ${e.width}*${e.height}，且图片数量不超过 ${e.max} 张`,type:"info","show-icon":"",closable:!1},null,8,["title"])])])),k(l).imageViewerVisible?(f(),B(D,{key:1,"url-list":a.value,"initial-index":k(l).dialogImageIndex,teleported:"",onClose:S},null,8,["url-list","initial-index"])):M("",!0)])}}}),_e=A(ge,[["__scopeId","data-v-2cbc6f3c"]]),ve=c("p",null,"ImageUpload / ImagesUpload / FileUpload",-1),we=c("p",{style:{"margin-bottom":"0"}}," 由于线上演示环境开启了 Mock ，会导致上传功能报错，请在本地运行并查看演示 ",-1),ke=N({name:"ComponentExampleUpload",__name:"upload.demo",setup(h){const _=j("https://picsum.photos/750/450"),r=j(["https://picsum.photos/400","https://picsum.photos/600","https://picsum.photos/500"]),$=j([{name:"测试文件.zip",url:"http://images.lookbi.com/uploads/apply/96/d8521fc691e472eec91a170201866e7d.zip"}]);function a(t){t.error===""?_.value=t.data.path:b.warning(t.error)}function l(t){t.error===""?r.value.push(t.data.path):b.warning(t.error)}function U(t,u,i){t.error===""?$.value.push({name:u.name,url:t.error===""?t.data.path:""}):(i.pop(),b.warning(t.error))}const S=[{image:"https://picsum.photos/750/450",images:["https://picsum.photos/400","https://picsum.photos/600","https://picsum.photos/500"]},{image:"https://picsum.photos/750/450",images:["https://picsum.photos/400","https://picsum.photos/600","https://picsum.photos/500"]},{image:"https://picsum.photos/750/450",images:["https://picsum.photos/400","https://picsum.photos/600","https://picsum.photos/500"]},{image:"https://picsum.photos/750/450",images:["https://picsum.photos/400","https://picsum.photos/600","https://picsum.photos/500"]}];return(t,u)=>{const i=x,n=Z,o=W,e=_e,y=ne,v=g("ElTableColumn"),d=g("ElTable");return f(),E("div",null,[s(i,{title:"上传"},{content:m(()=>[ve,we]),_:1}),s(o,{title:"单图上传"},{default:m(()=>[s(n,{url:k(_),"onUpdate:url":u[0]||(u[0]=p=>L(_)?_.value=p:null),action:"https://console-mock.apipost.cn/app/mock/project/1f50f1da-5189-4282-d3c7-c133a514c5a8/upload/image",name:"image",width:250,height:150,onOnSuccess:a},null,8,["url"])]),_:1}),s(o,{title:"多图上传（默认最多3张）"},{default:m(()=>[s(e,{modelValue:k(r),"onUpdate:modelValue":u[1]||(u[1]=p=>L(r)?r.value=p:null),action:"https://console-mock.apipost.cn/app/mock/project/1f50f1da-5189-4282-d3c7-c133a514c5a8/upload/image",name:"image",onOnSuccess:l},null,8,["modelValue"])]),_:1}),s(o,{title:"文件上传（默认最多3个）"},{default:m(()=>[s(y,{files:k($),action:"https://console-mock.apipost.cn/app/mock/project/1f50f1da-5189-4282-d3c7-c133a514c5a8/upload/file",onOnSuccess:U},null,8,["files"])]),_:1}),s(o,{title:"结合 el-table 使用"},{default:m(()=>[s(d,{data:S,style:{width:"100%"}},{default:m(()=>[s(v,{type:"index",width:"50",fixed:"left"}),s(v,{label:"单张图片"},{default:m(({row:p})=>[s(n,{url:p.image,"onUpdate:url":I=>p.image=I,action:"https://console-mock.apipost.cn/app/mock/project/1f50f1da-5189-4282-d3c7-c133a514c5a8/upload/image",name:"image",width:250,height:150,onOnSuccess:a},null,8,["url","onUpdate:url"])]),_:1}),s(v,{label:"多张图片"},{default:m(({row:p})=>[s(e,{url:p.images,"onUpdate:url":I=>p.images=I,action:"https://console-mock.apipost.cn/app/mock/project/1f50f1da-5189-4282-d3c7-c133a514c5a8/upload/image",name:"image",onOnSuccess:l},null,8,["url","onUpdate:url"])]),_:1})]),_:1})]),_:1})])}}});typeof P=="function"&&P(ke);export{ke as default};
