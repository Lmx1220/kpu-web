
/**
 * 由 admin 提供技术支持
 * Powered by admin
 * 代码仓库
 * Github https://github.com/Lmx1220/kpu-web
 */
    
import{_ as ne}from"./index.vue_vue_type_script_setup_true_lang-ia1rdtXp.js";import{_ as re}from"./index.vue_vue_type_script_setup_true_lang-BFWRDq6I.js";import{r as N,a6 as v,d as se,j as ie,u as ue,a8 as de,az as I,ah as pe,ci as H,aH as p,ca as me,o as z,a as fe,h as o,w as n,b as M,L as u,e as l,R as k,S as A,M as O,$ as T,f as D,g as L,n as ce,cc as ge,bB as be,l as ve,q as _e}from"./bootstrap-BssOdyNs.js";import{_ as ye}from"./index.vue_vue_type_script_setup_true_lang-CJRusrx0.js";import{c as F}from"./standardModuleExample-CQzOo0UJ.js";import{A as K}from"./index.vue_vue_type_script_setup_true_lang-DR3a7vmf.js";import{_ as Ee}from"./index.vue_vue_type_script_setup_true_lang-I0uwIufi.js";import{u as Me}from"./useTabbar-JflsEu91.js";import"./index-CI4shd_A.js";function xe(){const m=N({page:1,size:10,total:0,sizes:[2,10,20,50,100],layout:"total, sizes, ->, prev, pager, next, jumper"}),x=N({});function _(e){const a={};for(const s in e)if(Object.prototype.hasOwnProperty.call(e,s)){const r=e[s];typeof r=="string"&&r.trim()===""?a[s]=void 0:Array.isArray(r)?a[s]=r.map(E=>typeof E=="object"&&E!==null?_(E):E):typeof r=="object"&&r!==null?a[s]=_(r):a[s]=r}return a}function y(e,a){const s={current:v(m).page,size:v(m).size,model:{..._(v(e))},extra:{}};return a&&(Array.isArray(a)?a.forEach(r=>{r.prop=r.prop||r.name,r.type==="daterange"?e[r.name]&&(e[r.name][0]&&(s.extra[`${r.prop}_st`]=e[r.name][0]),e[r.name][1]&&(s.extra[`${r.prop}_ed`]=e[r.name][1])):s.extra[r.prop]=e[r.name],delete s.model[r.name]}):(a.prop=a.prop||a.name,a.type==="daterange"?e[a.name]&&(e[a.name][0]&&(s.extra[`${a.prop}_st`]=e[a.name][0]),e[a.name][1]&&(s.extra[`${a.prop}_ed`]=e[a.name][1])):s.extra[a.prop]=e[a.name],delete s.model[a.name])),v(m).sort&&v(m).order&&(s.sort=v(m).sort,s.order=v(m).order),s}function f(e){return new Promise(a=>{m.value.size=e,a()})}function w(e){return new Promise(a=>{m.value.page=e,a()})}function $(e,a){return new Promise(s=>{m.value.sort=e,m.value.order=a==="ascending"?"asc":"desc",s()})}function B(e){const a=x.value;e?Object.assign(a,e):a&&Object.keys(a).forEach(s=>{a[s]=void 0})}return{pagination:m,search:x,getParams:y,onSizeChange:f,onCurrentChange:w,onSortChange:$,resetQuery:B}}const Ve={style:{display:"flex","align-items":"center"}},Pe={style:{display:"flex","align-items":"center"}},ze=se({__name:"list",setup(m){const x=ie(),_=Me(),y=ue(),{pagination:f,getParams:w,onSizeChange:$,onCurrentChange:B}=xe(),e=N({loading:!1,tableAutoHeight:!1,formMode:"router",formModeProps:{visible:!1,id:"",type:void 0},search:{productName:"",title2:"",title3:"",title4:""},batch:{enable:!0,selectionDataList:[]},dataList:[]});de(()=>{a(),e.value.formMode==="router"&&I.on("get-data-list",()=>{a()})}),pe(()=>{e.value.formMode==="router"&&I.off("get-data-list")});async function a(d){d&&d===1&&(f.value.page=d),e.value.loading=!0;const t=w({...e.value.search}),b=await F.page(t);e.value.dataList=H(b,"records",[]),f.value.total=Number(b.total),f.value.page=Number(H(b,"current",1)),setTimeout(()=>{e.value.loading=!1},100)}function s(d){$(d).then(()=>a())}function r(d=1){B(d).then(()=>a())}function E(){e.value.formMode==="router"?y.settings.tabbar.enable&&y.settings.tabbar.mergeTabsBy!=="activeMenu"?_.open({name:"standardModuleExampleCreate",params:{type:"add"}}):x.push({name:"standardModuleExampleCreate",params:{type:"add"}}):(e.value.formModeProps.id="",e.value.formModeProps.visible=!0,e.value.formModeProps.type=K.ADD)}function R(d){e.value.formMode==="router"?y.settings.tabbar.enable&&y.settings.tabbar.mergeTabsBy!=="activeMenu"?_.open({name:"standardModuleExampleEdit",params:{id:d.id,type:"edit"}}):x.push({name:"standardModuleExampleEdit",params:{id:d.id,type:"edit"}}):(e.value.formModeProps.id=d.id,e.value.formModeProps.visible=!0,e.value.formModeProps.type=K.EDIT)}function q(d){let t=[];d?t.push(d.id):t=e.value.batch.selectionDataList.map(b=>b.id),ge.confirm(`确认删除数量「${t.length}」吗？`,"确认信息").then(()=>{F.remove(t).then(()=>{a(),be.success({message:"删除成功",center:!0})})}).catch(()=>{})}return(d,t)=>{const b=p("ElTag"),V=p("el-radio-button"),U=p("el-radio-group"),G=ye,h=p("ElInput"),P=p("ElFormItem"),C=ve,c=p("ElButton"),Q=p("ElForm"),J=re,W=p("ElDivider"),X=p("ElButtonGroup"),Y=p("ElSpace"),Z=p("el-table-column"),j=p("ElTableColumn"),ee=p("ElPopconfirm"),te=p("ElTable"),ae=p("el-pagination"),oe=ne,le=me("loading");return z(),fe("div",{class:ce({"absolute-container":l(e).tableAutoHeight})},[o(G,{title:"标准模块"},{description:n(()=>[M("p",null,[t[11]||(t[11]=u("标准模块即包含 CRUD (增查改删) 操作的基础模块，开发者可通过 ")),o(b,null,{default:n(()=>t[10]||(t[10]=[u("pnpm run new")])),_:1}),t[12]||(t[12]=u(" 命令快速生成一个标准模块，并在此基础上完善业务模块所需要的功能。"))]),t[20]||(t[20]=M("p",null," 同时，标准模块还提供了两个优秀的特性： ",-1)),M("p",Ve,[t[15]||(t[15]=M("span",{style:{"margin-inline-end":"20px"}},"特性1：列表展示模式",-1)),o(U,{modelValue:l(e).tableAutoHeight,"onUpdate:modelValue":t[0]||(t[0]=i=>l(e).tableAutoHeight=i),size:"large"},{default:n(()=>[o(V,{value:!1},{default:n(()=>t[13]||(t[13]=[u(" 默认 ")])),_:1}),o(V,{value:!0},{default:n(()=>t[14]||(t[14]=[u(" 列表高度自适应 ")])),_:1})]),_:1},8,["modelValue"])]),M("p",Pe,[t[19]||(t[19]=M("span",{style:{"margin-inline-end":"20px"}},"特性2：表单展示模式",-1)),o(U,{modelValue:l(e).formMode,"onUpdate:modelValue":t[1]||(t[1]=i=>l(e).formMode=i),size:"large"},{default:n(()=>[o(V,{value:"router"},{default:n(()=>t[16]||(t[16]=[u(" 路由跳转 ")])),_:1}),o(V,{value:"dialog"},{default:n(()=>t[17]||(t[17]=[u(" 对话框 ")])),_:1}),o(V,{value:"drawer"},{default:n(()=>t[18]||(t[18]=[u(" 抽屉 ")])),_:1})]),_:1},8,["modelValue"])])]),_:1}),o(oe,null,{default:n(()=>[o(J,{class:"relative","show-toggle":!1},{default:n(({fold:i,toggle:S})=>[o(Q,{model:l(e).search,size:"default","label-width":"100px","inline-message":"",inline:"",class:"search-form"},{default:n(()=>[o(P,{label:"标题"},{default:n(()=>[o(h,{modelValue:l(e).search.productName,"onUpdate:modelValue":t[2]||(t[2]=g=>l(e).search.productName=g),placeholder:"请输入标题，支持模糊查询",clearable:""},null,8,["modelValue"])]),_:1}),k(o(P,{label:"标题2"},{default:n(()=>[o(h,{modelValue:l(e).search.title2,"onUpdate:modelValue":t[3]||(t[3]=g=>l(e).search.title2=g),placeholder:"请输入标题，支持模糊查询",clearable:""},null,8,["modelValue"])]),_:2},1536),[[A,i]]),k(o(P,{label:"标题3"},{default:n(()=>[o(h,{modelValue:l(e).search.title3,"onUpdate:modelValue":t[4]||(t[4]=g=>l(e).search.title3=g),placeholder:"请输入标题，支持模糊查询",clearable:""},null,8,["modelValue"])]),_:2},1536),[[A,i]]),k(o(P,{label:"标题4"},{default:n(()=>[o(h,{modelValue:l(e).search.title4,"onUpdate:modelValue":t[5]||(t[5]=g=>l(e).search.title4=g),placeholder:"请输入标题，支持模糊查询",clearable:""},null,8,["modelValue"])]),_:2},1536),[[A,i]]),o(P,null,{default:n(()=>[o(c,{type:"primary",onClick:t[6]||(t[6]=g=>a())},{icon:n(()=>[o(C,{name:"i-ep:search"})]),default:n(()=>[t[21]||(t[21]=u(" 筛选 "))]),_:1}),o(c,{link:"",onClick:S},{icon:n(()=>[o(C,{name:i?"i-ep:caret-bottom":"i-ep:caret-top"},null,8,["name"])]),default:n(()=>[u(" "+O(i?"展开":"收起"),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["model"])]),_:1}),o(W),o(Y,null,{default:n(()=>[o(c,{type:"primary",onClick:t[7]||(t[7]=i=>E())},{icon:n(()=>[o(C,{name:"ep:plus"})]),default:n(()=>[u(" "+O(l(T)("common.title.addRoot")),1)]),_:1}),o(c,{disabled:!l(e).batch.selectionDataList.length},{default:n(()=>t[22]||(t[22]=[u(" 单个批量操作按钮 ")])),_:1},8,["disabled"]),l(e).batch.enable?(z(),D(X,{key:0},{default:n(()=>[o(c,{disabled:!l(e).batch.selectionDataList.length},{default:n(()=>t[23]||(t[23]=[u(" 单个批量操作按钮1 ")])),_:1},8,["disabled"]),o(c,{disabled:!l(e).batch.selectionDataList.length},{default:n(()=>t[24]||(t[24]=[u(" 单个批量操作按钮2 ")])),_:1},8,["disabled"])]),_:1})):L("",!0)]),_:1}),k((z(),D(te,{class:"list-table",data:l(e).dataList,stripe:"","highlight-current-row":"",border:"",onSelectionChange:t[8]||(t[8]=i=>l(e).batch.selectionDataList=i)},{default:n(()=>[l(e).batch.enable?(z(),D(Z,{key:0,type:"selection",align:"center",fixed:""})):L("",!0),o(j,{prop:"productName",label:l(T)("system.resource.title"),"min-width":"200",fixed:"left"},null,8,["label"]),o(j,{align:"center",fixed:"right",label:"操作",width:"350"},{default:n(i=>[o(c,{link:"",size:"small",type:"primary",onClick:S=>R(i.row)},{default:n(()=>t[25]||(t[25]=[u(" 编辑 ")])),_:2},1032,["onClick"]),o(ee,{title:l(T)("common.tips.confirmDelete"),onConfirm:S=>q(i.row)},{reference:n(()=>[o(c,{link:"",size:"small",type:"danger"},{default:n(()=>t[26]||(t[26]=[u(" 刪除 ")])),_:1})]),_:2},1032,["title","onConfirm"])]),_:1})]),_:1},8,["data"])),[[le,l(e).loading]]),o(ae,{"current-page":l(f).page,total:l(f).total,"page-size":l(f).size,"page-sizes":l(f).sizes,layout:l(f).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:s,onCurrentChange:r},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1}),["dialog","drawer"].includes(l(e).formMode)?(z(),D(Ee,{key:0,id:l(e).formModeProps.id,modelValue:l(e).formModeProps.visible,"onUpdate:modelValue":t[9]||(t[9]=i=>l(e).formModeProps.visible=i),type:l(e).formModeProps.type,mode:l(e).formMode,onSuccess:a},null,8,["id","modelValue","type","mode"])):L("",!0)],2)}}}),Te=_e(ze,[["__scopeId","data-v-e4153255"]]);export{Te as default};
