
/**
 * 由 admin 提供技术支持
 * Powered by admin
 * 代码仓库
 * Github https://github.com/Lmx1220/kpu-web
 */
    
import{r as L,P as v,d as ne,a as se,b as re,l as ie,J as I,Q as ue,R as N,B as p,S as de,o as z,c as pe,j as a,w as l,e as M,p as u,f as o,D as k,t as H,h,i as A,n as me,U as fe,V as ce,M as ge,_ as be,L as ve,G as T}from"./index-DAA47o_S.js";import{_ as _e}from"./index.vue_vue_type_script_setup_true_lang-DAEt_wLQ.js";import{_ as ye}from"./index.vue_vue_type_script_setup_true_lang-CyPx8pFQ.js";import{_ as Ee}from"./index.vue_vue_type_script_setup_true_lang-DXY3Gi1N.js";import{c as O,A as F}from"./index.vue_vue_type_script_setup_true_lang-KTU6ssKl.js";import{u as Me}from"./useTabbar-CQk-1YK-.js";import{_ as Ve}from"./_plugin-vue_export-helper-DlAUqK2U.js";function xe(){const m=L({page:1,size:10,total:0,sizes:[2,10,20,50,100],layout:"total, sizes, ->, prev, pager, next, jumper"}),V=L({});function _(n){const e={};for(const s in n)if(Object.prototype.hasOwnProperty.call(n,s)){const r=n[s];typeof r=="string"&&r.trim()===""?e[s]=void 0:Array.isArray(r)?e[s]=r.map(E=>typeof E=="object"&&E!==null?_(E):E):typeof r=="object"&&r!==null?e[s]=_(r):e[s]=r}return e}function y(n,e){const s={current:v(m).page,size:v(m).size,model:{..._(v(n))},extra:{}};return e&&(Array.isArray(e)?e.forEach(r=>{r.prop=r.prop||r.name,r.type==="daterange"?n[r.name]&&(n[r.name][0]&&(s.extra[`${r.prop}_st`]=n[r.name][0]),n[r.name][1]&&(s.extra[`${r.prop}_ed`]=n[r.name][1])):s.extra[r.prop]=n[r.name],delete s.model[r.name]}):(e.prop=e.prop||e.name,e.type==="daterange"?n[e.name]&&(n[e.name][0]&&(s.extra[`${e.prop}_st`]=n[e.name][0]),n[e.name][1]&&(s.extra[`${e.prop}_ed`]=n[e.name][1])):s.extra[e.prop]=n[e.name],delete s.model[e.name])),v(m).sort&&v(m).order&&(s.sort=v(m).sort,s.order=v(m).order),s}function f(n){return new Promise(e=>{m.value.size=n,e()})}function w(n){return new Promise(e=>{m.value.page=n,e()})}function B(n,e){return new Promise(s=>{m.value.sort=n,m.value.order=e==="ascending"?"asc":"desc",s()})}function C(n){const e=V.value;n?Object.assign(e,n):e&&Object.keys(e).forEach(s=>{e[s]=void 0})}return{pagination:m,search:V,getParams:y,onSizeChange:f,onCurrentChange:w,onSortChange:B,resetQuery:C}}const Pe={style:{display:"flex","align-items":"center"}},ze={style:{display:"flex","align-items":"center"}},De=ne({__name:"list",setup(m){const V=se(),_=Me(),y=re(),{pagination:f,getParams:w,onSizeChange:B,onCurrentChange:C}=xe(),{t:n}=fe(),e=L({loading:!1,tableAutoHeight:!1,formMode:"router",formModeProps:{visible:!1,id:"",type:void 0},search:{title:"",title2:"",title3:"",title4:""},batch:{enable:!0,selectionDataList:[]},dataList:[]});ie(()=>{s(),e.value.formMode==="router"&&I.on("get-data-list",()=>{s()})}),ue(()=>{e.value.formMode==="router"&&I.off("get-data-list")});async function s(d){d&&d===1&&(f.value.page=d),e.value.loading=!0;const t=w({...e.value.search}),b=await O.page(t);e.value.dataList=N(b,"records",[]),f.value.total=Number(b.total),f.value.page=Number(N(b,"current",1)),setTimeout(()=>{e.value.loading=!1},100)}function r(d){B(d).then(()=>s())}function E(d=1){C(d).then(()=>s())}function R(){e.value.formMode==="router"?y.settings.tabbar.enable&&y.settings.tabbar.mergeTabsBy!=="activeMenu"?_.open({name:"standardModuleExampleCreate",params:{type:"add"}}):V.push({name:"standardModuleExampleCreate",params:{type:"add"}}):(e.value.formModeProps.id="",e.value.formModeProps.visible=!0,e.value.formModeProps.type=F.ADD)}function G(d){e.value.formMode==="router"?y.settings.tabbar.enable&&y.settings.tabbar.mergeTabsBy!=="activeMenu"?_.open({name:"standardModuleExampleEdit",params:{id:d.id,type:"edit"}}):V.push({name:"standardModuleExampleEdit",params:{id:d.id,type:"edit"}}):(e.value.formModeProps.id=d.id,e.value.formModeProps.visible=!0,e.value.formModeProps.type=F.EDIT)}function Q(d){let t=[];d?t.push(d.id):t=e.value.batch.selectionDataList.map(b=>b.id),ce.confirm(`确认删除数量「${t.length}」吗？`,"确认信息").then(()=>{O.remove(t).then(()=>{s(),ge.success({message:"删除成功",center:!0})})}).catch(()=>{})}return(d,t)=>{const b=p("ElTag"),x=p("el-radio-button"),U=p("el-radio-group"),q=ye,D=p("ElInput"),P=p("ElFormItem"),S=be,c=p("ElButton"),J=p("ElForm"),K=_e,W=p("ElDivider"),X=p("ElButtonGroup"),Y=p("ElSpace"),Z=p("el-table-column"),j=p("ElTableColumn"),ee=p("ElPopconfirm"),te=p("ElTable"),ae=p("el-pagination"),oe=ve,le=de("loading");return z(),pe("div",{class:me({"absolute-container":o(e).tableAutoHeight})},[a(q,{title:"标准模块"},{content:l(()=>[M("p",null,[t[11]||(t[11]=u("标准模块即包含 CRUD (增查改删) 操作的基础模块，开发者可通过 ")),a(b,null,{default:l(()=>t[10]||(t[10]=[u("pnpm run new")])),_:1}),t[12]||(t[12]=u(" 命令快速生成一个标准模块，并在此基础上完善业务模块所需要的功能。"))]),t[20]||(t[20]=M("p",null," 同时，标准模块还提供了两个优秀的特性： ",-1)),M("p",Pe,[t[15]||(t[15]=M("span",{style:{"margin-inline-end":"20px"}},"特性1：列表展示模式",-1)),a(U,{modelValue:o(e).tableAutoHeight,"onUpdate:modelValue":t[0]||(t[0]=i=>o(e).tableAutoHeight=i),size:"large"},{default:l(()=>[a(x,{value:!1},{default:l(()=>t[13]||(t[13]=[u(" 默认 ")])),_:1}),a(x,{value:!0},{default:l(()=>t[14]||(t[14]=[u(" 列表高度自适应 ")])),_:1})]),_:1},8,["modelValue"])]),M("p",ze,[t[19]||(t[19]=M("span",{style:{"margin-inline-end":"20px"}},"特性2：表单展示模式",-1)),a(U,{modelValue:o(e).formMode,"onUpdate:modelValue":t[1]||(t[1]=i=>o(e).formMode=i),size:"large"},{default:l(()=>[a(x,{value:"router"},{default:l(()=>t[16]||(t[16]=[u(" 路由跳转 ")])),_:1}),a(x,{value:"dialog"},{default:l(()=>t[17]||(t[17]=[u(" 对话框 ")])),_:1}),a(x,{value:"drawer"},{default:l(()=>t[18]||(t[18]=[u(" 抽屉 ")])),_:1})]),_:1},8,["modelValue"])])]),_:1}),a(oe,null,{default:l(()=>[a(K,{class:"relative","show-toggle":!1},{default:l(({fold:i,toggle:$})=>[a(J,{model:o(e).search,size:"default","label-width":"100px","inline-message":"",inline:"",class:"search-form"},{default:l(()=>[a(P,{label:"标题"},{default:l(()=>[a(D,{modelValue:o(e).search.title,"onUpdate:modelValue":t[2]||(t[2]=g=>o(e).search.title=g),placeholder:"请输入标题，支持模糊查询",clearable:""},null,8,["modelValue"])]),_:1}),k(a(P,{label:"标题2"},{default:l(()=>[a(D,{modelValue:o(e).search.title2,"onUpdate:modelValue":t[3]||(t[3]=g=>o(e).search.title2=g),placeholder:"请输入标题，支持模糊查询",clearable:""},null,8,["modelValue"])]),_:2},1536),[[T,i]]),k(a(P,{label:"标题3"},{default:l(()=>[a(D,{modelValue:o(e).search.title3,"onUpdate:modelValue":t[4]||(t[4]=g=>o(e).search.title3=g),placeholder:"请输入标题，支持模糊查询",clearable:""},null,8,["modelValue"])]),_:2},1536),[[T,i]]),k(a(P,{label:"标题4"},{default:l(()=>[a(D,{modelValue:o(e).search.title4,"onUpdate:modelValue":t[5]||(t[5]=g=>o(e).search.title4=g),placeholder:"请输入标题，支持模糊查询",clearable:""},null,8,["modelValue"])]),_:2},1536),[[T,i]]),a(P,null,{default:l(()=>[a(c,{type:"primary",onClick:t[6]||(t[6]=g=>s())},{icon:l(()=>[a(S,{name:"i-ep:search"})]),default:l(()=>[t[21]||(t[21]=u(" 筛选 "))]),_:1}),a(c,{link:"",onClick:$},{icon:l(()=>[a(S,{name:i?"i-ep:caret-bottom":"i-ep:caret-top"},null,8,["name"])]),default:l(()=>[u(" "+H(i?"展开":"收起"),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["model"])]),_:1}),a(W),a(Y,null,{default:l(()=>[a(c,{type:"primary",onClick:t[7]||(t[7]=i=>R())},{icon:l(()=>[a(S,{name:"ep:plus"})]),default:l(()=>[u(" "+H(o(n)("common.title.addRoot")),1)]),_:1}),a(c,{disabled:!o(e).batch.selectionDataList.length},{default:l(()=>t[22]||(t[22]=[u(" 单个批量操作按钮 ")])),_:1},8,["disabled"]),o(e).batch.enable?(z(),h(X,{key:0},{default:l(()=>[a(c,{disabled:!o(e).batch.selectionDataList.length},{default:l(()=>t[23]||(t[23]=[u(" 单个批量操作按钮1 ")])),_:1},8,["disabled"]),a(c,{disabled:!o(e).batch.selectionDataList.length},{default:l(()=>t[24]||(t[24]=[u(" 单个批量操作按钮2 ")])),_:1},8,["disabled"])]),_:1})):A("",!0)]),_:1}),k((z(),h(te,{class:"list-table",data:o(e).dataList,stripe:"","highlight-current-row":"",border:"",onSelectionChange:t[8]||(t[8]=i=>o(e).batch.selectionDataList=i)},{default:l(()=>[o(e).batch.enable?(z(),h(Z,{key:0,type:"selection",align:"center",fixed:""})):A("",!0),a(j,{prop:"title",label:o(n)("system.resource.title"),"min-width":"200",fixed:"left"},null,8,["label"]),a(j,{align:"center",fixed:"right",label:"操作",width:"350"},{default:l(i=>[a(c,{link:"",size:"small",type:"primary",onClick:$=>G(i.row)},{default:l(()=>t[25]||(t[25]=[u(" 编辑 ")])),_:2},1032,["onClick"]),a(ee,{title:o(n)("common.tips.confirmDelete"),onConfirm:$=>Q(i.row)},{reference:l(()=>[a(c,{link:"",size:"small",type:"danger"},{default:l(()=>t[26]||(t[26]=[u(" 刪除 ")])),_:1})]),_:2},1032,["title","onConfirm"])]),_:1})]),_:1},8,["data"])),[[le,o(e).loading]]),a(ae,{"current-page":o(f).page,total:o(f).total,"page-size":o(f).size,"page-sizes":o(f).sizes,layout:o(f).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:r,onCurrentChange:E},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1}),["dialog","drawer"].includes(o(e).formMode)?(z(),h(Ee,{key:0,id:o(e).formModeProps.id,modelValue:o(e).formModeProps.visible,"onUpdate:modelValue":t[9]||(t[9]=i=>o(e).formModeProps.visible=i),type:o(e).formModeProps.type,mode:o(e).formMode,onSuccess:s},null,8,["id","modelValue","type","mode"])):A("",!0)],2)}}}),Ae=Ve(De,[["__scopeId","data-v-a6618f2f"]]);export{Ae as default};
