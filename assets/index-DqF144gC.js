
/**
 * 由 admin 提供技术支持
 * Powered by admin
 * 代码仓库
 * Github https://github.com/Lmx1220/kpu-web
 */
    
import{d as aa,bl as ta,k as ea,l as sa,u as ia,aX as na,bm as la,bn as oa,B as da,c as S,aZ as N,r as ca,v as K,C as A,aw as ra,bo as z,aN as w,D as U,G as ba,o as b,b as g,h as T,J as E,f as i,e as f,j as v,w as m,aV as fa,n as D,F as ua,m as pa,i as B,aU as ha,y as C,x as ga,bp as M,H as va,I as ka,_ as _a,aI as ma,s as xa}from"./index-putfknEa.js";import{_ as Pa}from"./index.vue_vue_type_script_setup_true_lang-COAeLD2v.js";import{u as F}from"./index-DQXu1pRM.js";import{S as Ia}from"./sortable.esm-C83syoBY.js";import ya from"./moreAction-CeY9fNkF.js";import{u as Sa}from"./useTabbar-CyYdn1mD.js";import{u as wa}from"./useMainPage-B_1Q84YL.js";import"./index.vue_vue_type_script_setup_true_lang-B0Xuimgy.js";import"./index.vue_vue_type_script_setup_true_lang-C2ukESE2.js";import"./index.vue_vue_type_script_setup_true_lang-BjneWBqv.js";import"./index-DaouMrR2.js";import"./vee-validate-zod-DFzDRMRC.js";import"./index-GW34aOAv.js";import"./index.vue_vue_type_script_setup_true_lang-CrH7osH_.js";const Ta={class:"tabbar"},Ca={class:"tabbar-container"},Ma=["data-index","title","onClick","onDblclick"],Ra={class:"size-full"},$a={class:"tab-content"},La={key:0,class:"action-icon"},Na=["onClick"],za={class:"text-sm"},Da={class:"text-accent-foreground/50"},Ba={class:"absolute end-0 top-0 z-10 h-full w-50px flex-center"},Wa=aa({name:"Tabbar",__name:"index",setup(Oa){ta(a=>({"1f8f1e2b":i(J),"1fc2878f":i(X)}));const G=ea(),p=sa(),d=ia(),n=na(),c=Sa(),W=wa(),H=la({reactive:!0}),{t:u}=oa(),{generateI18nTitle:R}=da(),r=S(()=>c.getId()),j=S(()=>n.list.length>1&&(c.checkCloseOtherSide()||c.checkCloseLeftSide()||c.checkCloseRightSide())),x=N("tabsRef"),P=N("tabContainerRef"),k=N("tabRef"),J=S(()=>{var s,o;const a=n.list.findIndex(l=>l.tabId===r.value);return`${((o=(s=k.value)==null?void 0:s.find(l=>l.dataset.index&&Number.parseInt(l.dataset.index)===a))==null?void 0:o.offsetLeft)||0}px`}),X=S(()=>{var s,o;const a=n.list.findIndex(l=>l.tabId===r.value);return`${((o=(s=k.value)==null?void 0:s.find(l=>l.dataset.index&&Number.parseInt(l.dataset.index)===a))==null?void 0:o.offsetWidth)||0}px`}),I=ca(!1);let y;K(()=>{P.value&&(y=new Ia(P.value.$el,{animation:300,delay:400,delayOnTouchOnly:!0,ghostClass:"tab-ghost",draggable:".tab",handle:".drag-handle",onStart:()=>{I.value=!0},onEnd:()=>{I.value=!1},onMove:a=>{const e=a.dragged,s=a.related;return e.classList.contains("pinned")?s.classList.contains("pinned"):!s.classList.contains("pinned")},onUpdate:a=>{a.newIndex!==void 0&&a.oldIndex!==void 0&&n.sort(a.newIndex,a.oldIndex)}}))}),A([()=>d.mode,()=>d.settings.app.direction],a=>{ra(()=>{y==null||y.option("disabled",a[0]==="mobile"||a[1]==="rtl")})},{immediate:!0}),A(()=>G,a=>{d.settings.tabbar.enable&&n.add(a).then(()=>{var s,o;const e=n.list.findIndex(l=>l.tabId===r.value);e!==-1&&(k.value&&((o=x.value)==null||o.scrollTo(k.value[e].offsetLeft-((s=x.value.ref)==null?void 0:s.$el.clientWidth)*.4)),Z())})},{immediate:!0,deep:!0});function Z(){var a,e,s;if(((a=P.value)==null?void 0:a.$el.clientWidth)>(((s=(e=x.value)==null?void 0:e.ref)==null?void 0:s.$el.clientWidth)??0)&&localStorage.getItem("tabbarScrollTip")===void 0){z.local.set("tabbarScrollTip","");const o=w.info("温馨提示",{description:"标签栏数量超过展示区域范围，可以将鼠标移到标签栏上，通过鼠标滚轮滑动浏览",position:"top-center",duration:1/0,action:{label:"知道了",onClick:()=>w.dismiss(o)}})}}function q(){if(!z.local.has("tabbarMaximizeTip")){z.local.set("tabbarMaximizeTip","");const a=w.info("温馨提示",{description:"可以通过双击标签栏进行最大化操作",position:"top-center",duration:1/0,action:{label:"知道了",onClick:()=>w.dismiss(a)}})}}function Q(a){switch(d.settings.tabbar.dblclickAction){case"reload":W.reload();break;case"close":c.closeById(a.tabId);break;case"pin":a.isPin?n.unPin(a.tabId):n.pin(a.tabId);break;case"maximize":d.setMainPageMaximize();break;case"window":window.open(p.resolve(a.fullPath).href,"_blank");break}}function Y(a){return[[{label:u("app.tabbar.reload"),icon:"i-ri:refresh-line",disabled:a.tabId!==r.value,handle:()=>W.reload()},{label:u("app.tabbar.close"),icon:"i-ri:close-line",disabled:n.list.length<=1||a.isPin||a.isPermanent,divided:!0,handle:()=>{c.closeById(a.tabId)}},{label:a.isPin?u("app.tabbar.unpin"):u("app.tabbar.pin"),icon:a.isPin?"i-lucide:pin-off":"i-lucide:pin",disabled:a.fullPath===d.settings.home.fullPath||a.isPermanent,handle:()=>{a.isPin?n.unPin(a.tabId):n.pin(a.tabId)}},{label:u("app.tabbar.maximize"),icon:"i-ri:picture-in-picture-exit-line",handle:()=>{a.tabId!==r.value&&p.push(a.fullPath),q(),d.setMainPageMaximize()}},{label:u("app.tabbar.newWindow"),icon:"i-ci:window",divided:!0,handle:()=>{const e=p.resolve(a.fullPath);window.open(e.href,"_blank")}},{label:u("app.tabbar.closeOtherSide"),disabled:!c.checkCloseOtherSide(a.tabId),handle:()=>{c.closeOtherSide(a.tabId)}},{label:u("app.tabbar.closeLeftSide"),disabled:!c.checkCloseLeftSide(a.tabId),handle:()=>{c.closeLeftSide(a.tabId)}},{label:u("app.tabbar.closeRightSide"),disabled:!c.checkCloseRightSide(a.tabId),handle:()=>{c.closeRightSide(a.tabId)}}]]}function O(a,e,s){let o;return!a&&e||a&&!s?o=e:a&&s&&(o=s),o}return K(()=>{U("alt+left,alt+right,alt+w,alt+1,alt+2,alt+3,alt+4,alt+5,alt+6,alt+7,alt+8,alt+9,alt+0",(a,e)=>{var s,o;if(d.settings.tabbar.enable&&d.settings.tabbar.enableHotkeys)switch(a.preventDefault(),e.key){case"alt+left":if(n.list[0].tabId!==r.value){const l=n.list.findIndex(_=>_.tabId===r.value);p.push(n.list[l-1].fullPath)}break;case"alt+right":if(((s=n.list.at(-1))==null?void 0:s.tabId)!==r.value){const l=n.list.findIndex(_=>_.tabId===r.value);p.push(n.list[l+1].fullPath)}break;case"alt+w":c.closeById(r.value);break;case"alt+1":case"alt+2":case"alt+3":case"alt+4":case"alt+5":case"alt+6":case"alt+7":case"alt+8":case"alt+9":{const l=Number(e.key.split("+")[1]);(o=n.list[l-1])!=null&&o.fullPath&&p.push(n.list[l-1].fullPath);break}case"alt+0":p.push(n.list[n.list.length-1].fullPath);break}})}),ba(()=>{U.unbind("alt+left,alt+righ,alt+w,alt+1,alt+2,alt+3,alt+4,alt+5,alt+6,alt+7,alt+8,alt+9,alt+0")}),(a,e)=>{const s=_a,o=ma,l=Pa,_=ha;return b(),g("div",Ta,[(b(),T(E(i(F)("tabbar-start")))),f("div",Ca,[v(_,{ref_key:"tabsRef",ref:x,scrollbar:!1,mask:"",horizontal:"","gradient-color":"var(--g-tabbar-bg)",class:D(["tabs",{"tabs-ontop":i(d).settings.topbar.switchTabbarAndToolbar,[`tabs-${i(d).settings.tabbar.style}`]:i(d).settings.tabbar.style!==""}])},{default:m(()=>[v(fa,{ref_key:"tabContainerRef",ref:P,name:i(I)?void 0:"tabbar",tag:"div",class:D(["tab-container",{dragging:i(I)}])},{default:m(()=>[(b(!0),g(ua,null,pa(i(n).list,(t,$)=>{var V;return b(),g("div",{key:i(d).settings.tabbar.mergeTabsBy==="routeName"&&t.routeName?t.routeName:t.tabId,ref_for:!0,ref_key:"tabRef",ref:k,"data-index":$,class:D(["tab",{"tab-ontop":i(d).settings.topbar.switchTabbarAndToolbar,actived:t.tabId===i(r),pinned:t.isPermanent||t.isPin}]),title:((V=t.customTitleList.find(h=>h.fullPath===t.fullPath))==null?void 0:V.title)||i(R)(t.title),onClick:h=>i(p).push(t.fullPath),onDblclick:h=>Q(t)},[v(l,{items:Y(t)},{default:m(()=>[f("div",Ra,[e[3]||(e[3]=f("div",{class:"tab-dividers"},null,-1)),e[4]||(e[4]=f("div",{class:"tab-background"},null,-1)),v(o,{delay:1e3,side:"bottom"},{content:m(()=>[f("div",za,C(i(R)(t.title)),1),f("div",Da,C(t.fullPath),1)]),default:m(()=>{var h;return[f("div",$a,[(b(),g("div",{key:t.tabId,class:"title"},[i(d).settings.tabbar.enableIcon&&O(t.tabId===i(r),t.icon,t.activeIcon)?(b(),T(s,{key:0,name:O(t.tabId===i(r),t.icon,t.activeIcon),class:"icon"},null,8,["name"])):B("",!0),ga(" "+C(((h=t.customTitleList.find(L=>L.fullPath===t.fullPath))==null?void 0:h.title)||i(R)(t.title)),1)])),!t.isPermanent&&t.isPin?(b(),g("div",La,[v(s,{name:"i-ri:pushpin-2-fill",onClick:M(L=>i(n).unPin(t.tabId),["stop"]),onDblclick:e[0]||(e[0]=M(()=>{},["stop"]))},null,8,["onClick"])])):!t.isPermanent&&i(n).list.length>1?(b(),g("div",{key:1,class:"action-icon",onClick:M(L=>i(c).closeById(t.tabId),["stop"]),onDblclick:e[1]||(e[1]=M(()=>{},["stop"]))},[v(s,{name:"i-ri:close-fill"})],40,Na)):B("",!0),va(f("div",{class:"hotkey-number"},C($+1),513),[[ka,i(H).alt&&$<9]]),e[2]||(e[2]=f("div",{class:"drag-handle"},null,-1))])]}),_:2},1024)])]),_:2},1032,["items"])],42,Ma)}),128))]),_:1},8,["name","class"])]),_:1},8,["class"]),f("div",Ba,[i(j)?(b(),T(ya,{key:0})):B("",!0)])]),(b(),T(E(i(F)("tabbar-end"))))])}}}),Ya=xa(Wa,[["__scopeId","data-v-2ac4f8a3"]]);export{Ya as default};
