
/**
 * 由 admin 提供技术支持
 * Powered by admin
 * 代码仓库
 * Github https://github.com/Lmx1220/kpu-web
 */
    
import{d as N,e as g,o as f,M as B,w as d,f as U,i as p,h as t,N as j,y as $,_ as L,p as K,l as X,q as Y,z as D,aN as T,aO as G,r as M,O as J,X as Q,L as V,k as z,v as C,K as P,j as k,Y as A,U as W,V as F}from"./index-DtuMVnuH.js";import{_ as Z}from"./index-CVvt3FKh.js";import{_ as x}from"./index.vue_vue_type_script_setup_true_lang-CAPDcj2Q.js";const ee=m=>(K("data-v-4174b70f"),m=m(),X(),m),te={class:"slot"},se=ee(()=>p("div",{class:"el-upload__text"},[Y(" 将文件拖到此处，或"),p("em",null,"点击上传")],-1)),oe={key:0,class:"el-upload__tip"},ae={style:{display:"inline-block"}},le=N({name:"FileUpload",__name:"index",props:{action:{},headers:{},data:{},name:{default:"file"},size:{default:2},max:{default:3},files:{default:()=>[]},notip:{type:Boolean,default:!1},ext:{default:()=>["zip","rar"]}},emits:["onSuccess"],setup(m,{emit:_}){const c=m,b=_,s=o=>{const i=o.name.split(".").at(-1)??"",r=c.ext.includes(i),h=o.size/1024/1024<c.size;return r||$.error(`上传文件只支持 ${c.ext.join(" / ")} 格式！`),h||$.error(`上传文件大小不能超过 ${c.size}MB！`),r&&h},l=()=>{$.warning("文件上传超过限制")},S=(o,a,i)=>{b("onSuccess",o,a,i)};return(o,a)=>{const i=L,r=g("ElAlert"),h=g("ElUpload");return f(),B(h,{headers:o.headers,action:o.action,data:o.data,name:o.name,"before-upload":s,"on-exceed":l,"on-success":S,"file-list":o.files,limit:o.max,drag:""},{tip:d(()=>[o.notip?j("",!0):(f(),U("div",oe,[p("div",ae,[t(r,{title:`上传文件支持 ${o.ext.join(" / ")} 格式，单个文件大小不超过 ${o.size}MB，且文件数量不超过 ${o.max} 个`,type:"info","show-icon":"",closable:!1},null,8,["title"])])]))]),default:d(()=>[p("div",te,[t(i,{name:"i-ep:upload-filled",class:"el-icon--upload"}),se])]),_:1},8,["headers","action","data","name","file-list","limit"])}}}),ie=D(le,[["__scopeId","data-v-4174b70f"]]),ne={class:"upload-container"},pe={class:"mask"},ce={class:"actions"},ue=["onClick"],de=["onClick"],re=["onClick"],me=["onClick"],he={key:0,class:"el-upload__tip"},fe={style:{display:"inline-block"}},ge=N({name:"ImagesUpload",__name:"index",props:T({action:{},headers:{},data:{},name:{default:"file"},size:{default:2},max:{default:3},width:{default:150},height:{default:150},placeholder:{default:""},notip:{type:Boolean,default:!1},ext:{default:()=>["jpg","png","gif","bmp"]}},{modelValue:{default:[]},modelModifiers:{}}),emits:T(["onSuccess"],["update:modelValue"]),setup(m,{emit:_}){const c=m,b=_,s=G(m,"modelValue"),l=M({dialogImageIndex:0,imageViewerVisible:!1,progress:{preview:"",percent:0}});function S(e){l.value.dialogImageIndex=e,l.value.imageViewerVisible=!0}function o(){l.value.imageViewerVisible=!1}function a(e){s.value.splice(e,1)}function i(e,E){E==="left"&&e!==0&&(s.value[e]=s.value.splice(e-1,1,s.value[e])[0]),E==="right"&&e!==s.value.length-1&&(s.value[e]=s.value.splice(e+1,1,s.value[e])[0])}const r=e=>{const v=e.name.split(".").at(-1)??"",u=c.ext.includes(v),n=e.size/1024/1024<c.size;return u||$.error(`上传图片只支持 ${c.ext.join(" / ")} 格式！`),n||$.error(`上传图片大小不能超过 ${c.size}MB！`),u&&n&&(l.value.progress.preview=URL.createObjectURL(e)),u&&n},h=e=>{l.value.progress.percent=~~e.percent},y=e=>{l.value.progress.preview="",l.value.progress.percent=0,b("onSuccess",e)};return(e,E)=>{const v=g("ElImage"),u=L,n=g("ElProgress"),I=g("ElUpload"),R=g("ElAlert"),q=g("ElImageViewer");return f(),U("div",ne,[(f(!0),U(J,null,Q(s.value,(H,w)=>(f(),U("div",{key:w,class:"images"},[w<e.max?(f(),B(v,{key:0,src:H,style:V(`width:${e.width}px;height:${e.height}px;`),fit:"cover"},null,8,["src","style"])):j("",!0),p("div",pe,[p("div",ce,[p("span",{title:"预览",onClick:O=>S(w)},[t(u,{name:"i-ep:zoom-in",class:"icon"})],8,ue),p("span",{title:"移除",onClick:O=>a(w)},[t(u,{name:"i-ep:delete",class:"icon"})],8,de),z(p("span",{title:"左移",class:P({disabled:w===0}),onClick:O=>i(w,"left")},[t(u,{name:"i-ep:back",class:"icon"})],10,re),[[C,s.value.length>1]]),z(p("span",{title:"右移",class:P({disabled:w===s.value.length-1}),onClick:O=>i(w,"right")},[t(u,{name:"i-ep:right",class:"icon"})],10,me),[[C,s.value.length>1]])])])]))),128)),z(t(I,{"show-file-list":!1,headers:e.headers,action:e.action,data:e.data,name:e.name,"before-upload":r,"on-progress":h,"on-success":y,drag:"",class:"images-upload"},{default:d(()=>[p("div",{class:"image-slot",style:V(`width:${e.width}px;height:${e.height}px;`)},[t(u,{name:"i-ep:plus",class:"icon"})],4),z(p("div",{class:"progress",style:V(`width:${e.width}px;height:${e.height}px;`)},[t(v,{src:k(l).progress.preview,style:V(`width:${e.width}px;height:${e.height}px;`),fit:"fill"},null,8,["src","style"]),t(n,{type:"circle",width:Math.min(e.width,e.height)*.8,percentage:k(l).progress.percent},null,8,["width","percentage"])],4),[[C,k(l).progress.percent]])]),_:1},8,["headers","action","data","name"]),[[C,s.value.length<e.max]]),e.notip?j("",!0):(f(),U("div",he,[p("div",fe,[t(R,{title:`上传图片支持 ${e.ext.join(" / ")} 格式，单张图片大小不超过 ${e.size}MB，建议图片尺寸为 ${e.width}*${e.height}，且图片数量不超过 ${e.max} 张`,type:"info","show-icon":"",closable:!1},null,8,["title"])])])),k(l).imageViewerVisible?(f(),B(q,{key:1,"url-list":s.value,"initial-index":k(l).dialogImageIndex,teleported:"",onClose:o},null,8,["url-list","initial-index"])):j("",!0)])}}}),_e=D(ge,[["__scopeId","data-v-2cbc6f3c"]]),ve=p("p",null,"ImageUpload / ImagesUpload / FileUpload",-1),we=p("p",{style:{"margin-bottom":"0"}}," 由于线上演示环境开启了 Mock ，会导致上传功能报错，请在本地运行并查看演示 ",-1),ke=N({name:"ComponentExampleUpload",__name:"upload.demo",setup(m){const _=M("https://picsum.photos/750/450"),c=M(["https://picsum.photos/400","https://picsum.photos/600","https://picsum.photos/500"]),b=M([{name:"测试文件.zip",url:"http://images.lookbi.com/uploads/apply/96/d8521fc691e472eec91a170201866e7d.zip"}]);function s(a){a.error===""?_.value=a.data.path:$.warning(a.error)}function l(a){a.error===""?c.value.push(a.data.path):$.warning(a.error)}function S(a,i,r){a.error===""?b.value.push({name:i.name,url:a.error===""?a.data.path:""}):(r.pop(),$.warning(a.error))}const o=[{image:"https://picsum.photos/750/450",images:["https://picsum.photos/400","https://picsum.photos/600","https://picsum.photos/500"]},{image:"https://picsum.photos/750/450",images:["https://picsum.photos/400","https://picsum.photos/600","https://picsum.photos/500"]},{image:"https://picsum.photos/750/450",images:["https://picsum.photos/400","https://picsum.photos/600","https://picsum.photos/500"]},{image:"https://picsum.photos/750/450",images:["https://picsum.photos/400","https://picsum.photos/600","https://picsum.photos/500"]}];return(a,i)=>{const r=x,h=Z,y=W,e=_e,E=ie,v=g("ElTableColumn"),u=g("ElTable");return f(),U("div",null,[t(r,{title:"上传"},{content:d(()=>[ve,we]),_:1}),t(y,{title:"单图上传"},{default:d(()=>[t(h,{url:k(_),"onUpdate:url":i[0]||(i[0]=n=>A(_)?_.value=n:null),action:"https://console-mock.apipost.cn/app/mock/project/1f50f1da-5189-4282-d3c7-c133a514c5a8/upload/image",name:"image",width:250,height:150,onOnSuccess:s},null,8,["url"])]),_:1}),t(y,{title:"多图上传（默认最多3张）"},{default:d(()=>[t(e,{modelValue:k(c),"onUpdate:modelValue":i[1]||(i[1]=n=>A(c)?c.value=n:null),action:"https://console-mock.apipost.cn/app/mock/project/1f50f1da-5189-4282-d3c7-c133a514c5a8/upload/image",name:"image",onOnSuccess:l},null,8,["modelValue"])]),_:1}),t(y,{title:"文件上传（默认最多3个）"},{default:d(()=>[t(E,{files:k(b),action:"https://console-mock.apipost.cn/app/mock/project/1f50f1da-5189-4282-d3c7-c133a514c5a8/upload/file",onOnSuccess:S},null,8,["files"])]),_:1}),t(y,{title:"结合 el-table 使用"},{default:d(()=>[t(u,{data:o,style:{width:"100%"}},{default:d(()=>[t(v,{type:"index",width:"50",fixed:"left"}),t(v,{label:"单张图片"},{default:d(({row:n})=>[t(h,{url:n.image,"onUpdate:url":I=>n.image=I,action:"https://console-mock.apipost.cn/app/mock/project/1f50f1da-5189-4282-d3c7-c133a514c5a8/upload/image",name:"image",width:250,height:150,onOnSuccess:s},null,8,["url","onUpdate:url"])]),_:1}),t(v,{label:"多张图片"},{default:d(({row:n})=>[t(e,{url:n.images,"onUpdate:url":I=>n.images=I,action:"https://console-mock.apipost.cn/app/mock/project/1f50f1da-5189-4282-d3c7-c133a514c5a8/upload/image",name:"image",onOnSuccess:l},null,8,["url","onUpdate:url"])]),_:1})]),_:1})]),_:1})])}}});typeof F=="function"&&F(ke);export{ke as default};
