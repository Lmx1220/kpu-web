
/**
 * 由 admin 提供技术支持
 * Powered by admin
 * 代码仓库
 * Github https://github.com/Lmx1220/kpu-web
 */
    
import{r as L,bk as v,d as ne,j as se,u as re,Y as ie,m as ue,L as j,at as de,bl as N,I as p,b9 as pe,o as z,c as me,h as a,w as o,a as M,q as u,b as l,D,t as H,e as h,f as A,n as fe,ba as ce,N as be,_ as ge,M as ve,G as T,k as _e}from"./index-BhImQte4.js";import{_ as ye}from"./index.vue_vue_type_script_setup_true_lang-CsM8BIG2.js";import{_ as Ee}from"./index.vue_vue_type_script_setup_true_lang-HdufEI_y.js";import{c as O,A as F}from"./index.vue_vue_type_script_setup_true_lang-CkGO4ghM.js";import{_ as Me}from"./index.vue_vue_type_script_setup_true_lang-BRPofxJf.js";import{u as xe}from"./useTabbar-BsdjO6eY.js";function Ve(){const m=L({page:1,size:10,total:0,sizes:[2,10,20,50,100],layout:"total, sizes, ->, prev, pager, next, jumper"}),x=L({});function _(n){const e={};for(const s in n)if(Object.prototype.hasOwnProperty.call(n,s)){const r=n[s];typeof r=="string"&&r.trim()===""?e[s]=void 0:Array.isArray(r)?e[s]=r.map(E=>typeof E=="object"&&E!==null?_(E):E):typeof r=="object"&&r!==null?e[s]=_(r):e[s]=r}return e}function y(n,e){const s={current:v(m).page,size:v(m).size,model:{..._(v(n))},extra:{}};return e&&(Array.isArray(e)?e.forEach(r=>{r.prop=r.prop||r.name,r.type==="daterange"?n[r.name]&&(n[r.name][0]&&(s.extra[`${r.prop}_st`]=n[r.name][0]),n[r.name][1]&&(s.extra[`${r.prop}_ed`]=n[r.name][1])):s.extra[r.prop]=n[r.name],delete s.model[r.name]}):(e.prop=e.prop||e.name,e.type==="daterange"?n[e.name]&&(n[e.name][0]&&(s.extra[`${e.prop}_st`]=n[e.name][0]),n[e.name][1]&&(s.extra[`${e.prop}_ed`]=n[e.name][1])):s.extra[e.prop]=n[e.name],delete s.model[e.name])),v(m).sort&&v(m).order&&(s.sort=v(m).sort,s.order=v(m).order),s}function f(n){return new Promise(e=>{m.value.size=n,e()})}function w(n){return new Promise(e=>{m.value.page=n,e()})}function C(n,e){return new Promise(s=>{m.value.sort=n,m.value.order=e==="ascending"?"asc":"desc",s()})}function B(n){const e=x.value;n?Object.assign(e,n):e&&Object.keys(e).forEach(s=>{e[s]=void 0})}return{pagination:m,search:x,getParams:y,onSizeChange:f,onCurrentChange:w,onSortChange:C,resetQuery:B}}const Pe={style:{display:"flex","align-items":"center"}},ze={style:{display:"flex","align-items":"center"}},ke=ne({__name:"list",setup(m){const x=se(),_=xe(),y=re(),{pagination:f,getParams:w,onSizeChange:C,onCurrentChange:B}=Ve(),{t:n}=ie(),e=L({loading:!1,tableAutoHeight:!1,formMode:"router",formModeProps:{visible:!1,id:"",type:void 0},search:{title:"",title2:"",title3:"",title4:""},batch:{enable:!0,selectionDataList:[]},dataList:[]});ue(()=>{s(),e.value.formMode==="router"&&j.on("get-data-list",()=>{s()})}),de(()=>{e.value.formMode==="router"&&j.off("get-data-list")});async function s(d){d&&d===1&&(f.value.page=d),e.value.loading=!0;const t=w({...e.value.search}),g=await O.page(t);e.value.dataList=N(g,"records",[]),f.value.total=Number(g.total),f.value.page=Number(N(g,"current",1)),setTimeout(()=>{e.value.loading=!1},100)}function r(d){C(d).then(()=>s())}function E(d=1){B(d).then(()=>s())}function G(){e.value.formMode==="router"?y.settings.tabbar.enable&&y.settings.tabbar.mergeTabsBy!=="activeMenu"?_.open({name:"standardModuleExampleCreate",params:{type:"add"}}):x.push({name:"standardModuleExampleCreate",params:{type:"add"}}):(e.value.formModeProps.id="",e.value.formModeProps.visible=!0,e.value.formModeProps.type=F.ADD)}function R(d){e.value.formMode==="router"?y.settings.tabbar.enable&&y.settings.tabbar.mergeTabsBy!=="activeMenu"?_.open({name:"standardModuleExampleEdit",params:{id:d.id,type:"edit"}}):x.push({name:"standardModuleExampleEdit",params:{id:d.id,type:"edit"}}):(e.value.formModeProps.id=d.id,e.value.formModeProps.visible=!0,e.value.formModeProps.type=F.EDIT)}function q(d){let t=[];d?t.push(d.id):t=e.value.batch.selectionDataList.map(g=>g.id),ce.confirm(`确认删除数量「${t.length}」吗？`,"确认信息").then(()=>{O.remove(t).then(()=>{s(),be.success({message:"删除成功",center:!0})})}).catch(()=>{})}return(d,t)=>{const g=p("ElTag"),V=p("el-radio-button"),I=p("el-radio-group"),Q=Ee,k=p("ElInput"),P=p("ElFormItem"),S=ge,c=p("ElButton"),Y=p("ElForm"),J=ye,K=p("ElDivider"),W=p("ElButtonGroup"),X=p("ElSpace"),Z=p("el-table-column"),U=p("ElTableColumn"),ee=p("ElPopconfirm"),te=p("ElTable"),ae=p("el-pagination"),le=ve,oe=pe("loading");return z(),me("div",{class:fe({"absolute-container":l(e).tableAutoHeight})},[a(Q,{title:"标准模块"},{content:o(()=>[M("p",null,[t[11]||(t[11]=u("标准模块即包含 CRUD (增查改删) 操作的基础模块，开发者可通过 ")),a(g,null,{default:o(()=>t[10]||(t[10]=[u("pnpm run new")])),_:1}),t[12]||(t[12]=u(" 命令快速生成一个标准模块，并在此基础上完善业务模块所需要的功能。"))]),t[20]||(t[20]=M("p",null," 同时，标准模块还提供了两个优秀的特性： ",-1)),M("p",Pe,[t[15]||(t[15]=M("span",{style:{"margin-inline-end":"20px"}},"特性1：列表展示模式",-1)),a(I,{modelValue:l(e).tableAutoHeight,"onUpdate:modelValue":t[0]||(t[0]=i=>l(e).tableAutoHeight=i),size:"large"},{default:o(()=>[a(V,{value:!1},{default:o(()=>t[13]||(t[13]=[u(" 默认 ")])),_:1}),a(V,{value:!0},{default:o(()=>t[14]||(t[14]=[u(" 列表高度自适应 ")])),_:1})]),_:1},8,["modelValue"])]),M("p",ze,[t[19]||(t[19]=M("span",{style:{"margin-inline-end":"20px"}},"特性2：表单展示模式",-1)),a(I,{modelValue:l(e).formMode,"onUpdate:modelValue":t[1]||(t[1]=i=>l(e).formMode=i),size:"large"},{default:o(()=>[a(V,{value:"router"},{default:o(()=>t[16]||(t[16]=[u(" 路由跳转 ")])),_:1}),a(V,{value:"dialog"},{default:o(()=>t[17]||(t[17]=[u(" 对话框 ")])),_:1}),a(V,{value:"drawer"},{default:o(()=>t[18]||(t[18]=[u(" 抽屉 ")])),_:1})]),_:1},8,["modelValue"])])]),_:1}),a(le,null,{default:o(()=>[a(J,{class:"relative","show-toggle":!1},{default:o(({fold:i,toggle:$})=>[a(Y,{model:l(e).search,size:"default","label-width":"100px","inline-message":"",inline:"",class:"search-form"},{default:o(()=>[a(P,{label:"标题"},{default:o(()=>[a(k,{modelValue:l(e).search.title,"onUpdate:modelValue":t[2]||(t[2]=b=>l(e).search.title=b),placeholder:"请输入标题，支持模糊查询",clearable:""},null,8,["modelValue"])]),_:1}),D(a(P,{label:"标题2"},{default:o(()=>[a(k,{modelValue:l(e).search.title2,"onUpdate:modelValue":t[3]||(t[3]=b=>l(e).search.title2=b),placeholder:"请输入标题，支持模糊查询",clearable:""},null,8,["modelValue"])]),_:2},1536),[[T,i]]),D(a(P,{label:"标题3"},{default:o(()=>[a(k,{modelValue:l(e).search.title3,"onUpdate:modelValue":t[4]||(t[4]=b=>l(e).search.title3=b),placeholder:"请输入标题，支持模糊查询",clearable:""},null,8,["modelValue"])]),_:2},1536),[[T,i]]),D(a(P,{label:"标题4"},{default:o(()=>[a(k,{modelValue:l(e).search.title4,"onUpdate:modelValue":t[5]||(t[5]=b=>l(e).search.title4=b),placeholder:"请输入标题，支持模糊查询",clearable:""},null,8,["modelValue"])]),_:2},1536),[[T,i]]),a(P,null,{default:o(()=>[a(c,{type:"primary",onClick:t[6]||(t[6]=b=>s())},{icon:o(()=>[a(S,{name:"i-ep:search"})]),default:o(()=>[t[21]||(t[21]=u(" 筛选 "))]),_:1}),a(c,{link:"",onClick:$},{icon:o(()=>[a(S,{name:i?"i-ep:caret-bottom":"i-ep:caret-top"},null,8,["name"])]),default:o(()=>[u(" "+H(i?"展开":"收起"),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["model"])]),_:1}),a(K),a(X,null,{default:o(()=>[a(c,{type:"primary",onClick:t[7]||(t[7]=i=>G())},{icon:o(()=>[a(S,{name:"ep:plus"})]),default:o(()=>[u(" "+H(l(n)("common.title.addRoot")),1)]),_:1}),a(c,{disabled:!l(e).batch.selectionDataList.length},{default:o(()=>t[22]||(t[22]=[u(" 单个批量操作按钮 ")])),_:1},8,["disabled"]),l(e).batch.enable?(z(),h(W,{key:0},{default:o(()=>[a(c,{disabled:!l(e).batch.selectionDataList.length},{default:o(()=>t[23]||(t[23]=[u(" 单个批量操作按钮1 ")])),_:1},8,["disabled"]),a(c,{disabled:!l(e).batch.selectionDataList.length},{default:o(()=>t[24]||(t[24]=[u(" 单个批量操作按钮2 ")])),_:1},8,["disabled"])]),_:1})):A("",!0)]),_:1}),D((z(),h(te,{class:"list-table",data:l(e).dataList,stripe:"","highlight-current-row":"",border:"",onSelectionChange:t[8]||(t[8]=i=>l(e).batch.selectionDataList=i)},{default:o(()=>[l(e).batch.enable?(z(),h(Z,{key:0,type:"selection",align:"center",fixed:""})):A("",!0),a(U,{prop:"title",label:l(n)("system.resource.title"),"min-width":"200",fixed:"left"},null,8,["label"]),a(U,{align:"center",fixed:"right",label:"操作",width:"350"},{default:o(i=>[a(c,{link:"",size:"small",type:"primary",onClick:$=>R(i.row)},{default:o(()=>t[25]||(t[25]=[u(" 编辑 ")])),_:2},1032,["onClick"]),a(ee,{title:l(n)("common.tips.confirmDelete"),onConfirm:$=>q(i.row)},{reference:o(()=>[a(c,{link:"",size:"small",type:"danger"},{default:o(()=>t[26]||(t[26]=[u(" 刪除 ")])),_:1})]),_:2},1032,["title","onConfirm"])]),_:1})]),_:1},8,["data"])),[[oe,l(e).loading]]),a(ae,{"current-page":l(f).page,total:l(f).total,"page-size":l(f).size,"page-sizes":l(f).sizes,layout:l(f).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:r,onCurrentChange:E},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1}),["dialog","drawer"].includes(l(e).formMode)?(z(),h(Me,{key:0,id:l(e).formModeProps.id,modelValue:l(e).formModeProps.visible,"onUpdate:modelValue":t[9]||(t[9]=i=>l(e).formModeProps.visible=i),type:l(e).formModeProps.type,mode:l(e).formMode,onSuccess:s},null,8,["id","modelValue","type","mode"])):A("",!0)],2)}}}),$e=_e(ke,[["__scopeId","data-v-4a595e79"]]);export{$e as default};
