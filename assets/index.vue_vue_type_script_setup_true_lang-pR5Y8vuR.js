
/**
 * 由 admin 提供技术支持
 * Powered by admin
 * 代码仓库
 * Github https://github.com/Lmx1220/kpu-web
 */
    
import{r as N,I as P}from"./item-AaFN5m2P.js";import{_ as S}from"./sub.vue_vue_type_script_setup_true_lang-Cf2h6PwM.js";import{d as b,r as f,C as m,ax as w,au as B,o as c,b as d,F as y,m as E,n as O,aw as J,h as _,i as q}from"./index-putfknEa.js";const $=b({name:"MainMenu",__name:"index",props:{menu:{},value:{},mode:{default:"vertical"},collapse:{type:Boolean,default:!1},showCollapseName:{type:Boolean,default:!1},rounded:{type:Boolean,default:!1},direction:{default:"ltr"}},setup(g){const u=g,o=f(u.value),s=f({}),t=f({}),i=f([]),x=f([]);function k(e,l=[]){e.forEach(a=>{const n=a.path??JSON.stringify(a);if(a.children){const r=[...l,n];t.value[n]={index:n,indexPath:r,active:!1},k(a.children,r)}else s.value[n]={index:n,indexPath:l}})}const h=e=>{i.value.includes(e)||i.value.push(e)},v=e=>{if(Array.isArray(e)){J(()=>{v(e.at(-1)),e.length>1&&v(e.slice(0,-1))});return}Object.keys(t.value).forEach(l=>{t.value[l].indexPath.includes(e)&&(i.value=i.value.filter(a=>a!==e))})};function M(e){var l,a;for(const n in t.value)t.value[n].active=!1;(l=t.value[e])==null||l.indexPath.forEach(n=>{t.value[n].active=!0}),(a=s.value[e])==null||a.indexPath.forEach(n=>{t.value[n].active=!0})}const C=e=>{(u.mode==="horizontal"||u.collapse)&&(i.value=[]),M(e)},I=(e,l)=>{i.value.includes(e)?v(e):h(e)};function p(){const e=o.value&&s.value[o.value];M(o.value),!(!e||u.collapse)&&e.indexPath.forEach(l=>{const a=t.value[l];a&&h(l,a.indexPath)})}return m(()=>u.menu,e=>{k(e),p()},{deep:!0,immediate:!0}),m(()=>u.value,e=>{s.value[e]||(o.value="");const l=s.value[e]||o.value&&s.value[o.value]||s.value[u.value];l?o.value=l.index:o.value=e,p()}),m(()=>u.collapse,e=>{e&&(i.value=[]),p()}),w(N,B({props:u,items:s,subMenus:t,activeIndex:o,openedMenus:i,mouseInMenu:x,openMenu:h,closeMenu:v,handleMenuItemClick:C,handleSubMenuClick:I})),(e,l)=>(c(),d("div",{class:O(["h-full w-full flex flex-col of-hidden transition-all",{"flex-row! w-auto!":u.mode==="horizontal","py-1":u.mode==="vertical"}])},[(c(!0),d(y,null,E(e.menu,a=>{var n,r;return c(),d(y,{key:a.path??JSON.stringify(a)},[((n=a.meta)==null?void 0:n.menu)!==!1?(c(),d(y,{key:0},[(r=a.children)!=null&&r.length?(c(),_(S,{key:0,menu:a,"unique-key":[a.path??JSON.stringify(a)]},null,8,["menu","unique-key"])):(c(),_(P,{key:1,item:a,"unique-key":[a.path??JSON.stringify(a)],onClick:z=>C(a.path??JSON.stringify(a))},null,8,["item","unique-key","onClick"]))],64)):q("",!0)],64)}),128))],2))}});export{$ as _};
